<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>News-2 – 1</title>
<style id="applicationStylesheet" type="text/css">
	.mediaViewInfo {
		--web-view-name: News-2 – 1;
		--web-view-id: News-2__1;
		--web-scale-on-resize: true;
		--web-enable-deep-linking: true;
	}
	:root {
		--web-view-ids: News-2__1;
	}
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
		border: none;
	}
	#News-2__1 {
		position: absolute;
		width: 445px;
		height: 1655px;
		background-color: rgba(255,255,255,1);
		overflow: hidden;
		--web-view-name: News-2 – 1;
		--web-view-id: News-2__1;
		--web-scale-on-resize: true;
		--web-enable-deep-linking: true;
	}
	@keyframes fadein {
	
		0% {
			opacity: 0;
		}
		100% {
			opacity: 1;
		}
	
	}
	#Rectngulo_13 {
		filter: blur(8px);
		fill: rgba(93,93,93,1);
	}
	.Rectngulo_13 {
		position: absolute;
		overflow: visible;
		width: 469px;
		height: 1650px;
		left: 12px;
		top: 27px;
	}
	#Rectngulo_14 {
		fill: rgba(0,0,0,1);
		stroke: rgba(112,112,112,1);
		stroke-width: 1px;
		stroke-linejoin: miter;
		stroke-linecap: butt;
		stroke-miterlimit: 4;
		shape-rendering: auto;
	}
	.Rectngulo_14 {
		position: absolute;
		overflow: visible;
		width: 417px;
		height: 1578px;
		left: 14px;
		top: 32px;
	}
	#Sustraccin_4 {
		position: absolute;
		width: 375px;
		height: 817px;
		left: 31px;
		top: 52px;
		overflow: visible;
	}
	#Rectngulo_21 {
		fill: rgba(255,255,255,1);
	}
	.Rectngulo_21 {
		width: 375px;
		height: 1442px;
		position: absolute;
		overflow: visible;
		transform: matrix(1,0,0,1,31,150) rotate(180deg);
		transform-origin: center;
	}
	#Grupo_2 {
		position: absolute;
		width: 45px;
		height: 45px;
		left: 48px;
		top: 84px;
		overflow: visible;
		--web-animation: fadein 1s ease-in-out;
		--web-action-type: page;
		--web-action-target: 4_Home.html;
		cursor: pointer;
	}
	#Rectngulo_22 {
		fill: rgba(255,255,255,1);
	}
	.Rectngulo_22 {
		position: absolute;
		overflow: visible;
		width: 45px;
		height: 45px;
		left: 0px;
		top: 0px;
	}
	#Icon_ionic-ios-arrow-back {
		fill: rgba(0,0,0,1);
	}
	.Icon_ionic-ios-arrow-back {
		overflow: visible;
		position: absolute;
		width: 13.503px;
		height: 23.619px;
		left: 13.85px;
		top: 10.691px;
		transform: matrix(1,0,0,1,0,0);
	}
	#News {
		left: 110.5px;
		top: 183.407px;
		position: absolute;
		overflow: visible;
		width: 63px;
		white-space: nowrap;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: bold;
		font-size: 25px;
		color: rgba(0,0,0,1);
	}
	#Lucy_Mission_News_from_NASA {
		left: 57px;
		top: 231px;
		position: absolute;
		overflow: visible;
		width: 210px;
		white-space: nowrap;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: bold;
		font-size: 15px;
		color: rgba(0,0,0,1);
	}
	#NASAs_Lucy_Mission_Prepares_fo {
		left: 127px;
		top: 289px;
		position: absolute;
		overflow: visible;
		width: 229px;
		white-space: nowrap;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: normal;
		font-size: 12px;
		color: rgba(0,0,0,1);
	}
	#Rectngulo_17 {
		fill: rgba(0,0,0,1);
	}
	.Rectngulo_17 {
		width: 18.424px;
		height: 18.424px;
		position: absolute;
		overflow: visible;
		transform: matrix(1,0,0,1,67.7292,189.1441) rotate(44deg);
		transform-origin: center;
	}
	#Layer_2 {
		position: absolute;
		width: 48px;
		height: 39.28px;
		left: 70px;
		top: 278.86px;
		overflow: visible;
	}
	#Grupo_13 {
		position: absolute;
		width: 48px;
		height: 39.28px;
		left: 0px;
		top: 0px;
		overflow: visible;
	}
	#Grupo_8 {
		position: absolute;
		width: 39.28px;
		height: 39.28px;
		left: 2.672px;
		top: 0px;
		overflow: visible;
	}
	#Elipse_19 {
		fill: rgba(11,61,145,1);
	}
	.Elipse_19 {
		position: absolute;
		overflow: visible;
		width: 39.28px;
		height: 39.28px;
		left: 0px;
		top: 0px;
	}
	#Grupo_9 {
		position: absolute;
		width: 30.608px;
		height: 33.578px;
		left: 7.792px;
		top: 1.45px;
		overflow: visible;
	}
	#Elipse_20 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_20 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 13.141px;
		top: 2.103px;
	}
	#Elipse_21 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_21 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 15.401px;
		top: 2.396px;
	}
	#Elipse_22 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_22 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 18.366px;
		top: 6.389px;
	}
	#Elipse_23 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_23 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 2.103px;
		top: 26.939px;
	}
	#Elipse_24 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_24 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 2.675px;
		top: 28.7px;
	}
	#Elipse_25 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_25 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 0px;
		top: 27.258px;
	}
	#Elipse_26 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_26 {
		position: absolute;
		overflow: visible;
		width: 0.331px;
		height: 0.331px;
		left: 8.954px;
		top: 30.718px;
	}
	#Elipse_27 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_27 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 22.998px;
		top: 27.801px;
	}
	#Elipse_28 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_28 {
		position: absolute;
		overflow: visible;
		width: 0.331px;
		height: 0.331px;
		left: 27.078px;
		top: 23.368px;
	}
	#Elipse_29 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_29 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 7.075px;
		top: 7.732px;
	}
	#Elipse_30 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_30 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 11.567px;
		top: 4.433px;
	}
	#Elipse_31 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_31 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 11.079px;
		top: 4.11px;
	}
	#Elipse_32 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_32 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 10.639px;
		top: 3.787px;
	}
	#Elipse_33 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_33 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 7.78px;
		top: 8.584px;
	}
	#Elipse_34 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_34 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 14.396px;
		top: 0px;
	}
	#Elipse_35 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_35 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 15.482px;
		top: 4.756px;
	}
	#Elipse_36 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_36 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 13.769px;
		top: 3.827px;
	}
	#Elipse_37 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_37 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 10.833px;
		top: 5.09px;
	}
	#Elipse_38 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_38 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 23.779px;
		top: 32.157px;
	}
	#Elipse_39 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_39 {
		position: absolute;
		overflow: visible;
		width: 0.331px;
		height: 0.331px;
		left: 1.878px;
		top: 28.109px;
	}
	#Elipse_40 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_40 {
		position: absolute;
		overflow: visible;
		width: 0.331px;
		height: 0.331px;
		left: 13.357px;
		top: 30.238px;
	}
	#Elipse_41 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_41 {
		position: absolute;
		overflow: visible;
		width: 0.331px;
		height: 0.331px;
		left: 5.294px;
		top: 27.977px;
	}
	#Elipse_42 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_42 {
		position: absolute;
		overflow: visible;
		width: 0.331px;
		height: 0.331px;
		left: 6.722px;
		top: 30.307px;
	}
	#Elipse_43 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_43 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 17.232px;
		top: 28.84px;
	}
	#Elipse_44 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_44 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 23.027px;
		top: 25.57px;
	}
	#Elipse_45 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_45 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 27.419px;
		top: 27.577px;
	}
	#Elipse_46 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_46 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 28.917px;
		top: 28.535px;
	}
	#Elipse_47 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_47 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 29.163px;
		top: 25.922px;
	}
	#Elipse_48 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_48 {
		position: absolute;
		overflow: visible;
		width: 0.33px;
		height: 0.33px;
		left: 7.321px;
		top: 22.223px;
	}
	#Elipse_49 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_49 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 7.328px;
		top: 25.955px;
	}
	#Elipse_50 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_50 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 8.649px;
		top: 28.744px;
	}
	#Elipse_51 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_51 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 24.473px;
		top: 25.838px;
	}
	#Elipse_52 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_52 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 30.168px;
		top: 25.515px;
	}
	#Elipse_53 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_53 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 27.35px;
		top: 24.311px;
	}
	#Elipse_54 {
		fill: rgba(255,255,255,1);
	}
	.Elipse_54 {
		position: absolute;
		overflow: visible;
		width: 0.44px;
		height: 0.44px;
		left: 24.473px;
		top: 24.429px;
	}
	#Trazado_4 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_4 {
		overflow: visible;
		position: absolute;
		width: 1.585px;
		height: 1.586px;
		left: 17.721px;
		top: 1.354px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_5 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_5 {
		overflow: visible;
		position: absolute;
		width: 1.585px;
		height: 1.586px;
		left: 8.48px;
		top: 7.45px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_6 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_6 {
		overflow: visible;
		position: absolute;
		width: 1.584px;
		height: 1.586px;
		left: 28.95px;
		top: 23.566px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_7 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_7 {
		overflow: visible;
		position: absolute;
		width: 1.585px;
		height: 1.585px;
		left: 6.63px;
		top: 31.993px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_8 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_8 {
		overflow: visible;
		position: absolute;
		width: 1.585px;
		height: 1.585px;
		left: 27.21px;
		top: 27.883px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Grupo_11 {
		position: absolute;
		width: 48px;
		height: 35.904px;
		left: 0px;
		top: 1.644px;
		overflow: visible;
	}
	#Grupo_10 {
		position: absolute;
		width: 48px;
		height: 35.904px;
		left: 0px;
		top: 0px;
		overflow: visible;
	}
	#Trazado_9 {
		fill: rgba(252,61,33,1);
	}
	.Trazado_9 {
		overflow: visible;
		position: absolute;
		width: 48px;
		height: 35.904px;
		left: 0px;
		top: 0px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_10 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_10 {
		overflow: visible;
		position: absolute;
		width: 20.913px;
		height: 24.42px;
		left: 12.384px;
		top: 6.655px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Grupo_12 {
		position: absolute;
		width: 34.451px;
		height: 8.103px;
		left: 5.637px;
		top: 15.808px;
		overflow: visible;
	}
	#Trazado_11 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_11 {
		overflow: visible;
		position: absolute;
		width: 7.735px;
		height: 7.376px;
		left: 0px;
		top: 0.103px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_12 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_12 {
		overflow: visible;
		position: absolute;
		width: 8.668px;
		height: 7.376px;
		left: 25.783px;
		top: 0.103px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_13 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_13 {
		overflow: visible;
		position: absolute;
		width: 8.384px;
		height: 7.376px;
		left: 9.079px;
		top: 0.103px;
		transform: matrix(1,0,0,1,0,0);
	}
	#Trazado_14 {
		fill: rgba(255,255,255,1);
	}
	.Trazado_14 {
		overflow: visible;
		position: absolute;
		width: 6.505px;
		height: 8.103px;
		left: 18.721px;
		top: 0px;
		transform: matrix(1,0,0,1,0,0);
	}
	#NASA_has_tested_the_functions_ {
		left: 64px;
		top: 347px;
		position: absolute;
		overflow: visible;
		width: 304px;
		white-space: nowrap;
		line-height: 20px;
		margin-top: -4px;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: normal;
		font-size: 12px;
		color: rgba(0,0,0,1);
	}
	#The_Lucy_spacecraft_is_schedul {
		left: 64px;
		top: 1029px;
		position: absolute;
		overflow: visible;
		width: 304px;
		white-space: nowrap;
		line-height: 20px;
		margin-top: -4px;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: normal;
		font-size: 12px;
		color: rgba(0,0,0,1);
	}
	#The_spacecraft_will_sit_in_lau {
		left: 64px;
		top: 1266px;
		position: absolute;
		overflow: visible;
		width: 304px;
		white-space: nowrap;
		line-height: 20px;
		margin-top: -4px;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: normal;
		font-size: 12px;
		color: rgba(0,0,0,1);
	}
	#The_United_Launch_Alliance_ULA {
		left: 64px;
		top: 771px;
		position: absolute;
		overflow: visible;
		width: 140px;
		white-space: nowrap;
		line-height: 20px;
		margin-top: -4px;
		text-align: left;
		font-family: Roboto;
		font-style: normal;
		font-weight: normal;
		font-size: 12px;
		color: rgba(0,0,0,1);
	}
	#ksc-20210916-ph-kls01_0085_ori {
		filter: drop-shadow(0px 3px 6px rgba(0, 0, 0, 0.161));
		position: absolute;
		width: 136px;
		height: 240px;
		left: 219px;
		top: 764px;
		overflow: visible;
	}
</style>
<script id="applicationScript">
///////////////////////////////////////
// INITIALIZATION
///////////////////////////////////////

/**
 * Functionality for scaling, showing by media query, and navigation between multiple pages on a single page. 
 * Code subject to change.
 **/

if (window.console==null) { window["console"] = { log : function() {} } }; // some browsers do not set console

var Application = function() {
	// event constants
	this.prefix = "--web-";
	this.NAVIGATION_CHANGE = "viewChange";
	this.VIEW_NOT_FOUND = "viewNotFound";
	this.VIEW_CHANGE = "viewChange";
	this.VIEW_CHANGING = "viewChanging";
	this.STATE_NOT_FOUND = "stateNotFound";
	this.APPLICATION_COMPLETE = "applicationComplete";
	this.APPLICATION_RESIZE = "applicationResize";
	this.SIZE_STATE_NAME = "data-is-view-scaled";
	this.STATE_NAME = this.prefix + "state";

	this.lastTrigger = null;
	this.lastView = null;
	this.lastState = null;
	this.lastOverlay = null;
	this.currentView = null;
	this.currentState = null;
	this.currentOverlay = null;
	this.currentQuery = {index: 0, rule: null, mediaText: null, id: null};
	this.inclusionQuery = "(min-width: 0px)";
	this.exclusionQuery = "none and (min-width: 99999px)";
	this.LastModifiedDateLabelName = "LastModifiedDateLabel";
	this.viewScaleSliderId = "ViewScaleSliderInput";
	this.pageRefreshedName = "showPageRefreshedNotification";
	this.applicationStylesheet = null;
	this.mediaQueryDictionary = {};
	this.viewsDictionary = {};
	this.addedViews = [];
	this.views = {};
	this.viewIds = [];
	this.viewQueries = {};
	this.overlays = {};
	this.overlayIds = [];
	this.numberOfViews = 0;
	this.verticalPadding = 0;
	this.horizontalPadding = 0;
	this.stateName = null;
	this.viewScale = 1;
	this.viewLeft = 0;
	this.viewTop = 0;
	this.horizontalScrollbarsNeeded = false;
	this.verticalScrollbarsNeeded = false;

	// view settings
	this.showUpdateNotification = false;
	this.showNavigationControls = false;
	this.scaleViewsToFit = false;
	this.scaleToFitOnDoubleClick = false;
	this.actualSizeOnDoubleClick = false;
	this.scaleViewsOnResize = false;
	this.navigationOnKeypress = false;
	this.showViewName = false;
	this.enableDeepLinking = true;
	this.refreshPageForChanges = false;
	this.showRefreshNotifications = true;

	// view controls
	this.scaleViewSlider = null;
	this.lastModifiedLabel = null;
	this.supportsPopState = false; // window.history.pushState!=null;
	this.initialized = false;

	// refresh properties
	this.refreshDuration = 250;
	this.lastModifiedDate = null;
	this.refreshRequest = null;
	this.refreshInterval = null;
	this.refreshContent = null;
	this.refreshContentSize = null;
	this.refreshCheckContent = false;
	this.refreshCheckContentSize = false;

	var self = this;

	self.initialize = function(event) {
		var view = self.getVisibleView();
		var views = self.getVisibleViews();
		if (view==null) view = self.getInitialView();
		self.collectViews();
		self.collectOverlays();
		self.collectMediaQueries();

		for (let index = 0; index < views.length; index++) {
			var view = views[index];
			self.setViewOptions(view);
			self.setViewVariables(view);
			self.centerView(view);
		}

		// sometimes the body size is 0 so we call this now and again later
		if (self.initialized) {
			window.addEventListener(self.NAVIGATION_CHANGE, self.viewChangeHandler);
			window.addEventListener("keyup", self.keypressHandler);
			window.addEventListener("keypress", self.keypressHandler);
			window.addEventListener("resize", self.resizeHandler);
			window.document.addEventListener("dblclick", self.doubleClickHandler);

			if (self.supportsPopState) {
				window.addEventListener('popstate', self.popStateHandler);
			}
			else {
				window.addEventListener('hashchange', self.hashChangeHandler);
			}

			// we are ready to go
			window.dispatchEvent(new Event(self.APPLICATION_COMPLETE));
		}

		if (self.initialized==false) {
			if (self.enableDeepLinking) {
				self.syncronizeViewToURL();
			} 
	
			if (self.refreshPageForChanges) {
				self.setupRefreshForChanges();
			}
	
			self.initialized = true;
		}
		
		if (self.scaleViewsToFit) {
			self.viewScale = self.scaleViewToFit(view);
			
			if (self.viewScale<0) {
				setTimeout(self.scaleViewToFit, 500, view);
			}
		}
		else if (view) {
			self.viewScale = self.getViewScaleValue(view);
			self.centerView(view);
			self.updateSliderValue(self.viewScale);
		}
		else {
			// no view found
		}
	
		if (self.showUpdateNotification) {
			self.showNotification();
		}

		//"addEventListener" in window ? null : window.addEventListener = window.attachEvent;
		//"addEventListener" in document ? null : document.addEventListener = document.attachEvent;
	}


	///////////////////////////////////////
	// AUTO REFRESH 
	///////////////////////////////////////

	self.setupRefreshForChanges = function() {
		self.refreshRequest = new XMLHttpRequest();

		if (!self.refreshRequest) {
			return false;
		}

		// get document start values immediately
		self.requestRefreshUpdate();
	}

	/**
	 * Attempt to check the last modified date by the headers 
	 * or the last modified property from the byte array (experimental)
	 **/
	self.requestRefreshUpdate = function() {
		var url = document.location.href;
		var protocol = window.location.protocol;
		var method;
		
		try {

			if (self.refreshCheckContentSize) {
				self.refreshRequest.open('HEAD', url, true);
			}
			else if (self.refreshCheckContent) {
				self.refreshContent = document.documentElement.outerHTML;
				self.refreshRequest.open('GET', url, true);
				self.refreshRequest.responseType = "text";
			}
			else {

				// get page last modified date for the first call to compare to later
				if (self.lastModifiedDate==null) {

					// File system does not send headers in FF so get blob if possible
					if (protocol=="file:") {
						self.refreshRequest.open("GET", url, true);
						self.refreshRequest.responseType = "blob";
					}
					else {
						self.refreshRequest.open("HEAD", url, true);
						self.refreshRequest.responseType = "blob";
					}

					self.refreshRequest.onload = self.refreshOnLoadOnceHandler;

					// In some browsers (Chrome & Safari) this error occurs at send: 
					// 
					// Chrome - Access to XMLHttpRequest at 'file:///index.html' from origin 'null' 
					// has been blocked by CORS policy: 
					// Cross origin requests are only supported for protocol schemes: 
					// http, data, chrome, chrome-extension, https.
					// 
					// Safari - XMLHttpRequest cannot load file:///Users/user/Public/index.html. Cross origin requests are only supported for HTTP.
					// 
					// Solution is to run a local server, set local permissions or test in another browser
					self.refreshRequest.send(null);

					// In MS browsers the following behavior occurs possibly due to an AJAX call to check last modified date: 
					// 
					// DOM7011: The code on this page disabled back and forward caching.

					// In Brave (Chrome) error when on the server
					// index.js:221 HEAD https://www.example.com/ net::ERR_INSUFFICIENT_RESOURCES
					// self.refreshRequest.send(null);

				}
				else {
					self.refreshRequest = new XMLHttpRequest();
					self.refreshRequest.onreadystatechange = self.refreshHandler;
					self.refreshRequest.ontimeout = function() {
						self.log("Couldn't find page to check for updates");
					}
					
					var method;
					if (protocol=="file:") {
						method = "GET";
					}
					else {
						method = "HEAD";
					}

					//refreshRequest.open('HEAD', url, true);
					self.refreshRequest.open(method, url, true);
					self.refreshRequest.responseType = "blob";
					self.refreshRequest.send(null);
				}
			}
		}
		catch (error) {
			self.log("Refresh failed for the following reason:")
			self.log(error);
		}
	}

	self.refreshHandler = function() {
		var contentSize;

		try {

			if (self.refreshRequest.readyState === XMLHttpRequest.DONE) {
				
				if (self.refreshRequest.status === 2 || 
					self.refreshRequest.status === 200) {
					var pageChanged = false;

					self.updateLastModifiedLabel();

					if (self.refreshCheckContentSize) {
						var lastModifiedHeader = self.refreshRequest.getResponseHeader("Last-Modified");
						contentSize = self.refreshRequest.getResponseHeader("Content-Length");
						//lastModifiedDate = refreshRequest.getResponseHeader("Last-Modified");
						var headers = self.refreshRequest.getAllResponseHeaders();
						var hasContentHeader = headers.indexOf("Content-Length")!=-1;
						
						if (hasContentHeader) {
							contentSize = self.refreshRequest.getResponseHeader("Content-Length");

							// size has not been set yet
							if (self.refreshContentSize==null) {
								self.refreshContentSize = contentSize;
								// exit and let interval call this method again
								return;
							}

							if (contentSize!=self.refreshContentSize) {
								pageChanged = true;
							}
						}
					}
					else if (self.refreshCheckContent) {

						if (self.refreshRequest.responseText!=self.refreshContent) {
							pageChanged = true;
						}
					}
					else {
						lastModifiedHeader = self.getLastModified(self.refreshRequest);

						if (self.lastModifiedDate!=lastModifiedHeader) {
							self.log("lastModifiedDate:" + self.lastModifiedDate + ",lastModifiedHeader:" +lastModifiedHeader);
							pageChanged = true;
						}

					}

					
					if (pageChanged) {
						clearInterval(self.refreshInterval);
						self.refreshUpdatedPage();
						return;
					}

				}
				else {
					self.log('There was a problem with the request.');
				}

			}
		}
		catch( error ) {
			//console.log('Caught Exception: ' + error);
		}
	}

	self.refreshOnLoadOnceHandler = function(event) {

		// get the last modified date
		if (self.refreshRequest.response) {
			self.lastModifiedDate = self.getLastModified(self.refreshRequest);

			if (self.lastModifiedDate!=null) {

				if (self.refreshInterval==null) {
					self.refreshInterval = setInterval(self.requestRefreshUpdate, self.refreshDuration);
				}
			}
			else {
				self.log("Could not get last modified date from the server");
			}
		}
	}

	self.refreshUpdatedPage = function() {
		if (self.showRefreshNotifications) {
			var date = new Date().setTime((new Date().getTime()+10000));
			document.cookie = encodeURIComponent(self.pageRefreshedName) + "=true" + "; max-age=6000;" + " path=/";
		}

		document.location.reload(true);
	}

	self.showNotification = function(duration) {
		var notificationID = self.pageRefreshedName+"ID";
		var notification = document.getElementById(notificationID);
		if (duration==null) duration = 4000;

		if (notification!=null) {return;}

		notification = document.createElement("div");
		notification.id = notificationID;
		notification.textContent = "PAGE UPDATED";
		var styleRule = ""
		styleRule = "position: fixed; padding: 7px 16px 6px 16px; font-family: Arial, sans-serif; font-size: 10px; font-weight: bold; left: 50%;";
		styleRule += "top: 20px; background-color: rgba(0,0,0,.5); border-radius: 12px; color:rgb(235, 235, 235); transition: all 2s linear;";
		styleRule += "transform: translateX(-50%); letter-spacing: .5px; filter: drop-shadow(2px 2px 6px rgba(0, 0, 0, .1))";
		notification.setAttribute("style", styleRule);

		notification.className= "PageRefreshedClass";
		
		document.body.appendChild(notification);

		setTimeout(function() {
			notification.style.opacity = "0";
			notification.style.filter = "drop-shadow( 0px 0px 0px rgba(0,0,0, .5))";
			setTimeout(function() {
				notification.parentNode.removeChild(notification);
			}, duration)
		}, duration);

		document.cookie = encodeURIComponent(self.pageRefreshedName) + "=; max-age=1; path=/";
	}

	/**
	 * Get the last modified date from the header 
	 * or file object after request has been received
	 **/
	self.getLastModified = function(request) {
		var date;

		// file protocol - FILE object with last modified property
		if (request.response && request.response.lastModified) {
			date = request.response.lastModified;
		}
		
		// http protocol - check headers
		if (date==null) {
			date = request.getResponseHeader("Last-Modified");
		}

		return date;
	}

	self.updateLastModifiedLabel = function() {
		var labelValue = "";
		
		if (self.lastModifiedLabel==null) {
			self.lastModifiedLabel = document.getElementById("LastModifiedLabel");
		}

		if (self.lastModifiedLabel) {
			var seconds = parseInt(((new Date().getTime() - Date.parse(document.lastModified)) / 1000 / 60) * 100 + "");
			var minutes = 0;
			var hours = 0;

			if (seconds < 60) {
				seconds = Math.floor(seconds/10)*10;
				labelValue = seconds + " seconds";
			}
			else {
				minutes = parseInt((seconds/60) + "");

				if (minutes>60) {
					hours = parseInt((seconds/60/60) +"");
					labelValue += hours==1 ? " hour" : " hours";
				}
				else {
					labelValue = minutes+"";
					labelValue += minutes==1 ? " minute" : " minutes";
				}
			}
			
			if (seconds<10) {
				labelValue = "Updated now";
			}
			else {
				labelValue = "Updated " + labelValue + " ago";
			}

			if (self.lastModifiedLabel.firstElementChild) {
				self.lastModifiedLabel.firstElementChild.textContent = labelValue;

			}
			else if ("textContent" in self.lastModifiedLabel) {
				self.lastModifiedLabel.textContent = labelValue;
			}
		}
	}

	self.getShortString = function(string, length) {
		if (length==null) length = 30;
		string = string!=null ? string.substr(0, length).replace(/\n/g, "") : "[String is null]";
		return string;
	}

	self.getShortNumber = function(value, places) {
		if (places==null || places<1) places = 4;
		value = Math.round(value * Math.pow(10,places)) / Math.pow(10, places);
		return value;
	}

	///////////////////////////////////////
	// NAVIGATION CONTROLS
	///////////////////////////////////////

	self.updateViewLabel = function() {
		var viewNavigationLabel = document.getElementById("ViewNavigationLabel");
		var view = self.getVisibleView();
		var viewIndex = view ? self.getViewIndex(view) : -1;
		var viewName = view ? self.getViewPreferenceValue(view, self.prefix + "view-name") : null;
		var viewId = view ? view.id : null;

		if (viewNavigationLabel && view) {
			if (viewName && viewName.indexOf('"')!=-1) {
				viewName = viewName.replace(/"/g, "");
			}

			if (self.showViewName) {
				viewNavigationLabel.textContent = viewName;
				self.setTooltip(viewNavigationLabel, viewIndex + 1 + " of " + self.numberOfViews);
			}
			else {
				viewNavigationLabel.textContent = viewIndex + 1 + " of " + self.numberOfViews;
				self.setTooltip(viewNavigationLabel, viewName);
			}

		}
	}

	self.updateURL = function(view) {
		view = view == null ? self.getVisibleView() : view;
		var viewId = view ? view.id : null
		var viewFragment = view ? "#"+ viewId : null;

		if (viewId && self.viewIds.length>1 && self.enableDeepLinking) {

			if (self.supportsPopState==false) {
				self.setFragment(viewId);
			}
			else {
				if (viewFragment!=window.location.hash) {

					if (window.location.hash==null) {
						window.history.replaceState({name:viewId}, null, viewFragment);
					}
					else {
						window.history.pushState({name:viewId}, null, viewFragment);
					}
				}
			}
		}
	}

	self.updateURLState = function(view, stateName) {
		stateName = view && (stateName=="" || stateName==null) ? self.getStateNameByViewId(view.id) : stateName;

		if (self.supportsPopState==false) {
			self.setFragment(stateName);
		}
		else {
			if (stateName!=window.location.hash) {

				if (window.location.hash==null) {
					window.history.replaceState({name:view.viewId}, null, stateName);
				}
				else {
					window.history.pushState({name:view.viewId}, null, stateName);
				}
			}
		}
	}

	self.setFragment = function(value) {
		window.location.hash = "#" + value;
	}

	self.setTooltip = function(element, value) {
		// setting the tooltip in edge causes a page crash on hover
		if (/Edge/.test(navigator.userAgent)) { return; }

		if ("title" in element) {
			element.title = value;
		}
	}

	self.getStylesheetRules = function(styleSheet) {
		try {
			if (styleSheet) return styleSheet.cssRules || styleSheet.rules;
	
			return document.styleSheets[0]["cssRules"] || document.styleSheets[0]["rules"];
		}
		catch (error) {
			// ERRORS:
			// SecurityError: The operation is insecure.
			// Errors happen when script loads before stylesheet or loading an external css locally

			// InvalidAccessError: A parameter or an operation is not supported by the underlying object
			// Place script after stylesheet

			console.log(error);
			if (error.toString().indexOf("The operation is insecure")!=-1) {
				console.log("Load the stylesheet before the script or load the stylesheet inline until it can be loaded on a server")
			}
			return [];
		}
	}

	/**
	 * If single page application hide all of the views. 
	 * @param {Number} selectedIndex if provided shows the view at index provided
	 **/
	self.hideViews = function(selectedIndex, animation) {
		var rules = self.getStylesheetRules();
		var queryIndex = 0;
		var numberOfRules = rules!=null ? rules.length : 0;

		// loop through rules and hide media queries except selected
		for (var i=0;i<numberOfRules;i++) {
			var rule = rules[i];

			if (rule.media!=null) {

				if (queryIndex==selectedIndex) {
					self.currentQuery.mediaText = rule.conditionText;
					self.currentQuery.index = selectedIndex;
					self.currentQuery.rule = rule;
					self.enableMediaQuery(rule);
				}
				else {
					if (animation) {
						self.fadeOut(rule)
					}
					else {
						self.disableMediaQuery(rule);
					}
				}
				
				queryIndex++;
			}
		}

		self.numberOfViews = queryIndex;
		self.updateViewLabel();
		self.updateURL();

		self.dispatchViewChange();

		var view = self.getVisibleView();
		var viewIndex = view ? self.getViewIndex(view) : -1;

		return viewIndex==selectedIndex ? view : null;
	}

	/**
	 * Hide view
	 * @param {Object} view element to hide
	 **/
	self.hideView = function(view) {
		var rule = view ? self.mediaQueryDictionary[view.id] : null;

		if (rule) {
			self.disableMediaQuery(rule);
		}
	}

	/**
	 * Hide overlay
	 * @param {Object} overlay element to hide
	 **/
	self.hideOverlay = function(overlay) {
		var rule = overlay ? self.mediaQueryDictionary[overlay.id] : null;

		if (rule) {
			self.disableMediaQuery(rule);

			//if (self.showByMediaQuery) {
				overlay.style.display = "none";
			//}
		}
	}

	/**
	 * Show the view by media query. Does not hide current views
	 * Sets view options by default
	 * @param {Object} view element to show
	 * @param {Boolean} setViewOptions sets view options if null or true
	 */
	self.showViewByMediaQuery = function(view, setViewOptions) {
		var id = view ? view.id : null;
		var query = id ? self.mediaQueryDictionary[id] : null;
		var isOverlay = view ? self.isOverlay(view) : false;
		setViewOptions = setViewOptions==null ? true : setViewOptions;

		if (query) {
			self.enableMediaQuery(query);

			if (isOverlay && view && setViewOptions) {
				self.setViewVariables(null, view);
			}
			else {
				if (view && setViewOptions) self.setViewOptions(view);
				if (view && setViewOptions) self.setViewVariables(view);
			}
		}
	}

	/**
	 * Show the view. Does not hide current views
	 */
	self.showView = function(view, setViewOptions) {
		var id = view ? view.id : null;
		var query = id ? self.mediaQueryDictionary[id] : null;
		var display = null;
		setViewOptions = setViewOptions==null ? true : setViewOptions;

		if (query) {
			self.enableMediaQuery(query);
			if (view==null) view =self.getVisibleView();
			if (view && setViewOptions) self.setViewOptions(view);
		}
		else if (id) {
			display = window.getComputedStyle(view).getPropertyValue("display");
			if (display=="" || display=="none") {
				view.style.display = "block";
			}
		}

		if (view) {
			if (self.currentView!=null) {
				self.lastView = self.currentView;
			}

			self.currentView = view;
		}
	}

	self.showViewById = function(id, setViewOptions) {
		var view = id ? self.getViewById(id) : null;

		if (view) {
			self.showView(view);
			return;
		}

		self.log("View not found '" + id + "'");
	}

	self.getElementView = function(element) {
		var view = element;
		var viewFound = false;

		while (viewFound==false || view==null) {
			if (view && self.viewsDictionary[view.id]) {
				return view;
			}
			view = view.parentNode;
		}
	}

	/**
	 * Show overlay over view
	 * @param {Event | HTMLElement} event event or html element with styles applied
	 * @param {String} id id of view or view reference
	 * @param {Number} x x location
	 * @param {Number} y y location
	 */
	self.showOverlay = function(event, id, x, y) {
		var overlay = id && typeof id === 'string' ? self.getViewById(id) : id ? id : null;
		var query = overlay ? self.mediaQueryDictionary[overlay.id] : null;
		var centerHorizontally = false;
		var centerVertically = false;
		var anchorLeft = false;
		var anchorTop = false;
		var anchorRight = false;
		var anchorBottom = false;
		var display = null;
		var reparent = true;
		var view = null;
		
		if (overlay==null || overlay==false) {
			self.log("Overlay not found, '"+ id + "'");
			return;
		}

		// get enter animation - event target must have css variables declared
		if (event) {
			var button = event.currentTarget || event; // can be event or htmlelement
			var buttonComputedStyles = getComputedStyle(button);
			var actionTargetValue = buttonComputedStyles.getPropertyValue(self.prefix+"action-target").trim();
			var animation = buttonComputedStyles.getPropertyValue(self.prefix+"animation").trim();
			var isAnimated = animation!="";
			var targetType = buttonComputedStyles.getPropertyValue(self.prefix+"action-type").trim();
			var actionTarget = self.application ? null : self.getElement(actionTargetValue);
			var actionTargetStyles = actionTarget ? actionTarget.style : null;

			if (actionTargetStyles) {
				actionTargetStyles.setProperty("animation", animation);
			}

			if ("stopImmediatePropagation" in event) {
				event.stopImmediatePropagation();
			}
		}
		
		if (self.application==false || targetType=="page") {
			document.location.href = "./" + actionTargetValue;
			return;
		}

		// remove any current overlays
		if (self.currentOverlay) {

			// act as switch if same button
			if (self.currentOverlay==actionTarget || self.currentOverlay==null) {
				if (self.lastTrigger==button) {
					self.removeOverlay(isAnimated);
					return;
				}
			}
			else {
				self.removeOverlay(isAnimated);
			}
		}

		if (reparent) {
			view = self.getElementView(button);
			if (view) {
				view.appendChild(overlay);
			}
		}

		if (query) {
			//self.setElementAnimation(overlay, null);
			//overlay.style.animation = animation;
			self.enableMediaQuery(query);
			
			var display = overlay && overlay.style.display;
			
			if (overlay && display=="" || display=="none") {
				overlay.style.display = "block";
				//self.setViewOptions(overlay);
			}

			// add animation defined in event target style declaration
			if (animation && self.supportAnimations) {
				self.fadeIn(overlay, false, animation);
			}
		}
		else if (id) {

			display = window.getComputedStyle(overlay).getPropertyValue("display");

			if (display=="" || display=="none") {
				overlay.style.display = "block";
			}

			// add animation defined in event target style declaration
			if (animation && self.supportAnimations) {
				self.fadeIn(overlay, false, animation);
			}
		}

		// do not set x or y position if centering
		var horizontal = self.prefix + "center-horizontally";
		var vertical = self.prefix + "center-vertically";
		var style = overlay.style;
		var transform = [];

		centerHorizontally = self.getIsStyleDefined(id, horizontal) ? self.getViewPreferenceBoolean(overlay, horizontal) : false;
		centerVertically = self.getIsStyleDefined(id, vertical) ? self.getViewPreferenceBoolean(overlay, vertical) : false;
		anchorLeft = self.getIsStyleDefined(id, "left");
		anchorRight = self.getIsStyleDefined(id, "right");
		anchorTop = self.getIsStyleDefined(id, "top");
		anchorBottom = self.getIsStyleDefined(id, "bottom");

		
		if (self.viewsDictionary[overlay.id] && self.viewsDictionary[overlay.id].styleDeclaration) {
			style = self.viewsDictionary[overlay.id].styleDeclaration.style;
		}
		
		if (centerHorizontally) {
			style.left = "50%";
			style.transformOrigin = "0 0";
			transform.push("translateX(-50%)");
		}
		else if (anchorRight && anchorLeft) {
			style.left = x + "px";
		}
		else if (anchorRight) {
			//style.right = x + "px";
		}
		else {
			style.left = x + "px";
		}
		
		if (centerVertically) {
			style.top = "50%";
			transform.push("translateY(-50%)");
			style.transformOrigin = "0 0";
		}
		else if (anchorTop && anchorBottom) {
			style.top = y + "px";
		}
		else if (anchorBottom) {
			//style.bottom = y + "px";
		}
		else {
			style.top = y + "px";
		}

		if (transform.length) {
			style.transform = transform.join(" ");
		}

		self.currentOverlay = overlay;
		self.lastTrigger = button;
	}

	self.goBack = function() {
		if (self.currentOverlay) {
			self.removeOverlay();
		}
		else if (self.lastView) {
			self.goToView(self.lastView.id);
		}
	}

	self.removeOverlay = function(animate) {
		var overlay = self.currentOverlay;
		animate = animate===false ? false : true;

		if (overlay) {
			var style = overlay.style;
			
			if (style.animation && self.supportAnimations && animate) {
				self.reverseAnimation(overlay, true);

				var duration = self.getAnimationDuration(style.animation, true);
		
				setTimeout(function() {
					self.setElementAnimation(overlay, null);
					self.hideOverlay(overlay);
					self.currentOverlay = null;
				}, duration);
			}
			else {
				self.setElementAnimation(overlay, null);
				self.hideOverlay(overlay);
				self.currentOverlay = null;
			}
		}
	}

	/**
	 * Reverse the animation and hide after
	 * @param {Object} target element with animation
	 * @param {Boolean} hide hide after animation ends
	 */
	self.reverseAnimation = function(target, hide) {
		var lastAnimation = null;
		var style = target.style;

		style.animationPlayState = "paused";
		lastAnimation = style.animation;
		style.animation = null;
		style.animationPlayState = "paused";

		if (hide) {
			//target.addEventListener("animationend", self.animationEndHideHandler);
	
			var duration = self.getAnimationDuration(lastAnimation, true);
			var isOverlay = self.isOverlay(target);
	
			setTimeout(function() {
				self.setElementAnimation(target, null);

				if (isOverlay) {
					self.hideOverlay(target);
				}
				else {
					self.hideView(target);
				}
			}, duration);
		}

		setTimeout(function() {
			style.animation = lastAnimation;
			style.animationPlayState = "paused";
			style.animationDirection = "reverse";
			style.animationPlayState = "running";
		}, 30);
	}

	self.animationEndHandler = function(event) {
		var target = event.currentTarget;
		self.dispatchEvent(new Event(event.type));
	}

	self.isOverlay = function(view) {
		var result = view ? self.getViewPreferenceBoolean(view, self.prefix + "is-overlay") : false;

		return result;
	}

	self.animationEndHideHandler = function(event) {
		var target = event.currentTarget;
		self.setViewVariables(null, target);
		self.hideView(target);
		target.removeEventListener("animationend", self.animationEndHideHandler);
	}

	self.animationEndShowHandler = function(event) {
		var target = event.currentTarget;
		target.removeEventListener("animationend", self.animationEndShowHandler);
	}

	self.setViewOptions = function(view) {

		if (view) {
			self.minimumScale = self.getViewPreferenceValue(view, self.prefix + "minimum-scale");
			self.maximumScale = self.getViewPreferenceValue(view, self.prefix + "maximum-scale");
			self.scaleViewsToFit = self.getViewPreferenceBoolean(view, self.prefix + "scale-to-fit");
			self.scaleToFitType = self.getViewPreferenceValue(view, self.prefix + "scale-to-fit-type");
			self.scaleToFitOnDoubleClick = self.getViewPreferenceBoolean(view, self.prefix + "scale-on-double-click");
			self.actualSizeOnDoubleClick = self.getViewPreferenceBoolean(view, self.prefix + "actual-size-on-double-click");
			self.scaleViewsOnResize = self.getViewPreferenceBoolean(view, self.prefix + "scale-on-resize");
			self.enableScaleUp = self.getViewPreferenceBoolean(view, self.prefix + "enable-scale-up");
			self.centerHorizontally = self.getViewPreferenceBoolean(view, self.prefix + "center-horizontally");
			self.centerVertically = self.getViewPreferenceBoolean(view, self.prefix + "center-vertically");
			self.navigationOnKeypress = self.getViewPreferenceBoolean(view, self.prefix + "navigate-on-keypress");
			self.showViewName = self.getViewPreferenceBoolean(view, self.prefix + "show-view-name");
			self.refreshPageForChanges = self.getViewPreferenceBoolean(view, self.prefix + "refresh-for-changes");
			self.refreshPageForChangesInterval = self.getViewPreferenceValue(view, self.prefix + "refresh-interval");
			self.showNavigationControls = self.getViewPreferenceBoolean(view, self.prefix + "show-navigation-controls");
			self.scaleViewSlider = self.getViewPreferenceBoolean(view, self.prefix + "show-scale-controls");
			self.enableDeepLinking = self.getViewPreferenceBoolean(view, self.prefix + "enable-deep-linking");
			self.singlePageApplication = self.getViewPreferenceBoolean(view, self.prefix + "application");
			self.showByMediaQuery = self.getViewPreferenceBoolean(view, self.prefix + "show-by-media-query");
			self.showUpdateNotification = document.cookie!="" ? document.cookie.indexOf(self.pageRefreshedName)!=-1 : false;
			self.imageComparisonDuration = self.getViewPreferenceValue(view, self.prefix + "image-comparison-duration");
			self.supportAnimations = self.getViewPreferenceBoolean(view, self.prefix + "enable-animations", true);

			if (self.scaleViewsToFit) {
				var newScaleValue = self.scaleViewToFit(view);
				
				if (newScaleValue<0) {
					setTimeout(self.scaleViewToFit, 500, view);
				}
			}
			else {
				self.viewScale = self.getViewScaleValue(view);
				self.viewToFitWidthScale = self.getViewFitToViewportWidthScale(view, self.enableScaleUp)
				self.viewToFitHeightScale = self.getViewFitToViewportScale(view, self.enableScaleUp);
				self.updateSliderValue(self.viewScale);
			}

			if (self.imageComparisonDuration!=null) {
				// todo
			}

			if (self.refreshPageForChangesInterval!=null) {
				self.refreshDuration = Number(self.refreshPageForChangesInterval);
			}
		}
	}

	self.previousView = function(event) {
		var rules = self.getStylesheetRules();
		var view = self.getVisibleView()
		var index = view ? self.getViewIndex(view) : -1;
		var prevQueryIndex = index!=-1 ? index-1 : self.currentQuery.index-1;
		var queryIndex = 0;
		var numberOfRules = rules!=null ? rules.length : 0;

		if (event) {
			event.stopImmediatePropagation();
		}

		if (prevQueryIndex<0) {
			return;
		}

		// loop through rules and hide media queries except selected
		for (var i=0;i<numberOfRules;i++) {
			var rule = rules[i];
			
			if (rule.media!=null) {

				if (queryIndex==prevQueryIndex) {
					self.currentQuery.mediaText = rule.conditionText;
					self.currentQuery.index = prevQueryIndex;
					self.currentQuery.rule = rule;
					self.enableMediaQuery(rule);
					self.updateViewLabel();
					self.updateURL();
					self.dispatchViewChange();
				}
				else {
					self.disableMediaQuery(rule);
				}

				queryIndex++;
			}
		}
	}

	self.nextView = function(event) {
		var rules = self.getStylesheetRules();
		var view = self.getVisibleView();
		var index = view ? self.getViewIndex(view) : -1;
		var nextQueryIndex = index!=-1 ? index+1 : self.currentQuery.index+1;
		var queryIndex = 0;
		var numberOfRules = rules!=null ? rules.length : 0;
		var numberOfMediaQueries = self.getNumberOfMediaRules();

		if (event) {
			event.stopImmediatePropagation();
		}

		if (nextQueryIndex>=numberOfMediaQueries) {
			return;
		}

		// loop through rules and hide media queries except selected
		for (var i=0;i<numberOfRules;i++) {
			var rule = rules[i];
			
			if (rule.media!=null) {

				if (queryIndex==nextQueryIndex) {
					self.currentQuery.mediaText = rule.conditionText;
					self.currentQuery.index = nextQueryIndex;
					self.currentQuery.rule = rule;
					self.enableMediaQuery(rule);
					self.updateViewLabel();
					self.updateURL();
					self.dispatchViewChange();
				}
				else {
					self.disableMediaQuery(rule);
				}

				queryIndex++;
			}
		}
	}

	/**
	 * Enables a view via media query
	 */
	self.enableMediaQuery = function(rule) {

		try {
			rule.media.mediaText = self.inclusionQuery;
		}
		catch(error) {
			//self.log(error);
			rule.conditionText = self.inclusionQuery;
		}
	}

	self.disableMediaQuery = function(rule) {

		try {
			rule.media.mediaText = self.exclusionQuery;
		}
		catch(error) {
			rule.conditionText = self.exclusionQuery;
		}
	}

	self.dispatchViewChange = function() {
		try {
			var event = new Event(self.NAVIGATION_CHANGE);
			window.dispatchEvent(event);
		}
		catch (error) {
			// In IE 11: Object doesn't support this action
		}
	}

	self.getNumberOfMediaRules = function() {
		var rules = self.getStylesheetRules();
		var numberOfRules = rules ? rules.length : 0;
		var numberOfQueries = 0;

		for (var i=0;i<numberOfRules;i++) {
			if (rules[i].media!=null) { numberOfQueries++; }
		}
		
		return numberOfQueries;
	}

	/////////////////////////////////////////
	// VIEW SCALE 
	/////////////////////////////////////////

	self.sliderChangeHandler = function(event) {
		var value = self.getShortNumber(event.currentTarget.value/100);
		var view = self.getVisibleView();
		self.setViewScaleValue(view, false, value, true);
	}

	self.updateSliderValue = function(scale) {
		var slider = document.getElementById(self.viewScaleSliderId);
		var tooltip = parseInt(scale * 100 + "") + "%";
		var inputType;
		var inputValue;
		
		if (slider) {
			inputValue = self.getShortNumber(scale * 100);
			if (inputValue!=slider["value"]) {
				slider["value"] = inputValue;
			}
			inputType = slider.getAttributeNS(null, "type");

			if (inputType!="range") {
				// input range is not supported
				slider.style.display = "none";
			}

			self.setTooltip(slider, tooltip);
		}
	}

	self.viewChangeHandler = function(event) {
		var view = self.getVisibleView();
		var matrix = view ? getComputedStyle(view).transform : null;
		
		if (matrix) {
			self.viewScale = self.getViewScaleValue(view);
			
			var scaleNeededToFit = self.getViewFitToViewportScale(view);
			var isViewLargerThanViewport = scaleNeededToFit<1;
			
			// scale large view to fit if scale to fit is enabled
			if (self.scaleViewsToFit) {
				self.scaleViewToFit(view);
			}
			else {
				self.updateSliderValue(self.viewScale);
			}
		}
	}

	self.getViewScaleValue = function(view) {
		var matrix = getComputedStyle(view).transform;

		if (matrix) {
			var matrixArray = matrix.replace("matrix(", "").split(",");
			var scaleX = parseFloat(matrixArray[0]);
			var scaleY = parseFloat(matrixArray[3]);
			var scale = Math.min(scaleX, scaleY);
		}

		return scale;
	}

	/**
	 * Scales view to scale. 
	 * @param {Object} view view to scale. views are in views array
	 * @param {Boolean} scaleToFit set to true to scale to fit. set false to use desired scale value
	 * @param {Number} desiredScale scale to define. not used if scale to fit is false
	 * @param {Boolean} isSliderChange indicates if slider is callee
	 */
	self.setViewScaleValue = function(view, scaleToFit, desiredScale, isSliderChange) {
		var enableScaleUp = self.enableScaleUp;
		var scaleToFitType = self.scaleToFitType;
		var minimumScale = self.minimumScale;
		var maximumScale = self.maximumScale;
		var hasMinimumScale = !isNaN(minimumScale) && minimumScale!="";
		var hasMaximumScale = !isNaN(maximumScale) && maximumScale!="";
		var scaleNeededToFit = self.getViewFitToViewportScale(view, enableScaleUp);
		var scaleNeededToFitWidth = self.getViewFitToViewportWidthScale(view, enableScaleUp);
		var scaleNeededToFitHeight = self.getViewFitToViewportHeightScale(view, enableScaleUp);
		var scaleToFitFull = self.getViewFitToViewportScale(view, true);
		var scaleToFitFullWidth = self.getViewFitToViewportWidthScale(view, true);
		var scaleToFitFullHeight = self.getViewFitToViewportHeightScale(view, true);
		var scaleToWidth = scaleToFitType=="width";
		var scaleToHeight = scaleToFitType=="height";
		var shrunkToFit = false;
		var topPosition = null;
		var leftPosition = null;
		var translateY = null;
		var translateX = null;
		var transformValue = "";
		var canCenterVertically = true;
		var canCenterHorizontally = true;
		var style = view.style;

		if (view && self.viewsDictionary[view.id] && self.viewsDictionary[view.id].styleDeclaration) {
			style = self.viewsDictionary[view.id].styleDeclaration.style;
		}

		if (scaleToFit && isSliderChange!=true) {
			if (scaleToFitType=="fit" || scaleToFitType=="") {
				desiredScale = scaleNeededToFit;
			}
			else if (scaleToFitType=="width") {
				desiredScale = scaleNeededToFitWidth;
			}
			else if (scaleToFitType=="height") {
				desiredScale = scaleNeededToFitHeight;
			}
		}
		else {
			if (isNaN(desiredScale)) {
				desiredScale = 1;
			}
		}

		self.updateSliderValue(desiredScale);
		
		// scale to fit width
		if (scaleToWidth && scaleToHeight==false) {
			canCenterVertically = scaleNeededToFitHeight>=scaleNeededToFitWidth;
			canCenterHorizontally = scaleNeededToFitWidth>=1 && enableScaleUp==false;

			if (isSliderChange) {
				canCenterHorizontally = desiredScale<scaleToFitFullWidth;
			}
			else if (scaleToFit) {
				desiredScale = scaleNeededToFitWidth;
			}

			if (hasMinimumScale) {
				desiredScale = Math.max(desiredScale, Number(minimumScale));
			}

			if (hasMaximumScale) {
				desiredScale = Math.min(desiredScale, Number(maximumScale));
			}

			desiredScale = self.getShortNumber(desiredScale);

			canCenterHorizontally = self.canCenterHorizontally(view, "width", enableScaleUp, desiredScale, minimumScale, maximumScale);
			canCenterVertically = self.canCenterVertically(view, "width", enableScaleUp, desiredScale, minimumScale, maximumScale);

			if (desiredScale>1 && (enableScaleUp || isSliderChange)) {
				transformValue = "scale(" + desiredScale + ")";
			}
			else if (desiredScale>=1 && enableScaleUp==false) {
				transformValue = "scale(" + 1 + ")";
			}
			else {
				transformValue = "scale(" + desiredScale + ")";
			}

			if (self.centerVertically) {
				if (canCenterVertically) {
					translateY = "-50%";
					topPosition = "50%";
				}
				else {
					translateY = "0";
					topPosition = "0";
				}
				
				if (style.top != topPosition) {
					style.top = topPosition + "";
				}

				if (canCenterVertically) {
					transformValue += " translateY(" + translateY+ ")";
				}
			}

			if (self.centerHorizontally) {
				if (canCenterHorizontally) {
					translateX = "-50%";
					leftPosition = "50%";
				}
				else {
					translateX = "0";
					leftPosition = "0";
				}

				if (style.left != leftPosition) {
					style.left = leftPosition + "";
				}

				if (canCenterHorizontally) {
					transformValue += " translateX(" + translateX+ ")";
				}
			}

			style.transformOrigin = "0 0";
			style.transform = transformValue;

			self.viewScale = desiredScale;
			self.viewToFitWidthScale = scaleNeededToFitWidth;
			self.viewToFitHeightScale = scaleNeededToFitHeight;
			self.viewLeft = leftPosition;
			self.viewTop = topPosition;

			return desiredScale;
		}

		// scale to fit height
		if (scaleToHeight && scaleToWidth==false) {
			//canCenterVertically = scaleNeededToFitHeight>=scaleNeededToFitWidth;
			//canCenterHorizontally = scaleNeededToFitHeight<=scaleNeededToFitWidth && enableScaleUp==false;
			canCenterVertically = scaleNeededToFitHeight>=scaleNeededToFitWidth;
			canCenterHorizontally = scaleNeededToFitWidth>=1 && enableScaleUp==false;
			
			if (isSliderChange) {
				canCenterHorizontally = desiredScale<scaleToFitFullHeight;
			}
			else if (scaleToFit) {
				desiredScale = scaleNeededToFitHeight;
			}

			if (hasMinimumScale) {
				desiredScale = Math.max(desiredScale, Number(minimumScale));
			}

			if (hasMaximumScale) {
				desiredScale = Math.min(desiredScale, Number(maximumScale));
				//canCenterVertically = desiredScale>=scaleNeededToFitHeight && enableScaleUp==false;
			}

			desiredScale = self.getShortNumber(desiredScale);

			canCenterHorizontally = self.canCenterHorizontally(view, "height", enableScaleUp, desiredScale, minimumScale, maximumScale);
			canCenterVertically = self.canCenterVertically(view, "height", enableScaleUp, desiredScale, minimumScale, maximumScale);

			if (desiredScale>1 && (enableScaleUp || isSliderChange)) {
				transformValue = "scale(" + desiredScale + ")";
			}
			else if (desiredScale>=1 && enableScaleUp==false) {
				transformValue = "scale(" + 1 + ")";
			}
			else {
				transformValue = "scale(" + desiredScale + ")";
			}

			if (self.centerHorizontally) {
				if (canCenterHorizontally) {
					translateX = "-50%";
					leftPosition = "50%";
				}
				else {
					translateX = "0";
					leftPosition = "0";
				}

				if (style.left != leftPosition) {
					style.left = leftPosition + "";
				}

				if (canCenterHorizontally) {
					transformValue += " translateX(" + translateX+ ")";
				}
			}

			if (self.centerVertically) {
				if (canCenterVertically) {
					translateY = "-50%";
					topPosition = "50%";
				}
				else {
					translateY = "0";
					topPosition = "0";
				}
				
				if (style.top != topPosition) {
					style.top = topPosition + "";
				}

				if (canCenterVertically) {
					transformValue += " translateY(" + translateY+ ")";
				}
			}

			style.transformOrigin = "0 0";
			style.transform = transformValue;

			self.viewScale = desiredScale;
			self.viewToFitWidthScale = scaleNeededToFitWidth;
			self.viewToFitHeightScale = scaleNeededToFitHeight;
			self.viewLeft = leftPosition;
			self.viewTop = topPosition;

			return scaleNeededToFitHeight;
		}

		if (scaleToFitType=="fit") {
			//canCenterVertically = scaleNeededToFitHeight>=scaleNeededToFitWidth;
			//canCenterHorizontally = scaleNeededToFitWidth>=scaleNeededToFitHeight;
			canCenterVertically = scaleNeededToFitHeight>=scaleNeededToFit;
			canCenterHorizontally = scaleNeededToFitWidth>=scaleNeededToFit;

			if (hasMinimumScale) {
				desiredScale = Math.max(desiredScale, Number(minimumScale));
			}

			desiredScale = self.getShortNumber(desiredScale);

			if (isSliderChange || scaleToFit==false) {
				canCenterVertically = scaleToFitFullHeight>=desiredScale;
				canCenterHorizontally = desiredScale<scaleToFitFullWidth;
			}
			else if (scaleToFit) {
				desiredScale = scaleNeededToFit;
			}

			transformValue = "scale(" + desiredScale + ")";

			//canCenterHorizontally = self.canCenterHorizontally(view, "fit", false, desiredScale);
			//canCenterVertically = self.canCenterVertically(view, "fit", false, desiredScale);
			
			if (self.centerVertically) {
				if (canCenterVertically) {
					translateY = "-50%";
					topPosition = "50%";
				}
				else {
					translateY = "0";
					topPosition = "0";
				}
				
				if (style.top != topPosition) {
					style.top = topPosition + "";
				}

				if (canCenterVertically) {
					transformValue += " translateY(" + translateY+ ")";
				}
			}

			if (self.centerHorizontally) {
				if (canCenterHorizontally) {
					translateX = "-50%";
					leftPosition = "50%";
				}
				else {
					translateX = "0";
					leftPosition = "0";
				}

				if (style.left != leftPosition) {
					style.left = leftPosition + "";
				}

				if (canCenterHorizontally) {
					transformValue += " translateX(" + translateX+ ")";
				}
			}

			style.transformOrigin = "0 0";
			style.transform = transformValue;

			self.viewScale = desiredScale;
			self.viewToFitWidthScale = scaleNeededToFitWidth;
			self.viewToFitHeightScale = scaleNeededToFitHeight;
			self.viewLeft = leftPosition;
			self.viewTop = topPosition;

			self.updateSliderValue(desiredScale);
			
			return desiredScale;
		}

		if (scaleToFitType=="default" || scaleToFitType=="") {
			desiredScale = 1;

			if (hasMinimumScale) {
				desiredScale = Math.max(desiredScale, Number(minimumScale));
			}
			if (hasMaximumScale) {
				desiredScale = Math.min(desiredScale, Number(maximumScale));
			}

			canCenterHorizontally = self.canCenterHorizontally(view, "none", false, desiredScale, minimumScale, maximumScale);
			canCenterVertically = self.canCenterVertically(view, "none", false, desiredScale, minimumScale, maximumScale);

			if (self.centerVertically) {
				if (canCenterVertically) {
					translateY = "-50%";
					topPosition = "50%";
				}
				else {
					translateY = "0";
					topPosition = "0";
				}
				
				if (style.top != topPosition) {
					style.top = topPosition + "";
				}

				if (canCenterVertically) {
					transformValue += " translateY(" + translateY+ ")";
				}
			}

			if (self.centerHorizontally) {
				if (canCenterHorizontally) {
					translateX = "-50%";
					leftPosition = "50%";
				}
				else {
					translateX = "0";
					leftPosition = "0";
				}

				if (style.left != leftPosition) {
					style.left = leftPosition + "";
				}

				if (canCenterHorizontally) {
					transformValue += " translateX(" + translateX+ ")";
				}
				else {
					transformValue += " translateX(" + 0 + ")";
				}
			}

			style.transformOrigin = "0 0";
			style.transform = transformValue;


			self.viewScale = desiredScale;
			self.viewToFitWidthScale = scaleNeededToFitWidth;
			self.viewToFitHeightScale = scaleNeededToFitHeight;
			self.viewLeft = leftPosition;
			self.viewTop = topPosition;

			self.updateSliderValue(desiredScale);
			
			return desiredScale;
		}
	}

	/**
	 * Returns true if view can be centered horizontally
	 * @param {HTMLElement} view view
	 * @param {String} type type of scaling - width, height, all, none
	 * @param {Boolean} scaleUp if scale up enabled 
	 * @param {Number} scale target scale value 
	 */
	self.canCenterHorizontally = function(view, type, scaleUp, scale, minimumScale, maximumScale) {
		var scaleNeededToFit = self.getViewFitToViewportScale(view, scaleUp);
		var scaleNeededToFitHeight = self.getViewFitToViewportHeightScale(view, scaleUp);
		var scaleNeededToFitWidth = self.getViewFitToViewportWidthScale(view, scaleUp);
		var canCenter = false;
		var minScale;

		type = type==null ? "none" : type;
		scale = scale==null ? scale : scaleNeededToFitWidth;
		scaleUp = scaleUp == null ? false : scaleUp;

		if (type=="width") {
	
			if (scaleUp && maximumScale==null) {
				canCenter = false;
			}
			else if (scaleNeededToFitWidth>=1) {
				canCenter = true;
			}
		}
		else if (type=="height") {
			minScale = Math.min(1, scaleNeededToFitHeight);
			if (minimumScale!="" && maximumScale!="") {
				minScale = Math.max(minimumScale, Math.min(maximumScale, scaleNeededToFitHeight));
			}
			else {
				if (minimumScale!="") {
					minScale = Math.max(minimumScale, scaleNeededToFitHeight);
				}
				if (maximumScale!="") {
					minScale = Math.max(minimumScale, Math.min(maximumScale, scaleNeededToFitHeight));
				}
			}
	
			if (scaleUp && maximumScale=="") {
				canCenter = false;
			}
			else if (scaleNeededToFitWidth>=minScale) {
				canCenter = true;
			}
		}
		else if (type=="fit") {
			canCenter = scaleNeededToFitWidth>=scaleNeededToFit;
		}
		else {
			if (scaleUp) {
				canCenter = false;
			}
			else if (scaleNeededToFitWidth>=1) {
				canCenter = true;
			}
		}

		self.horizontalScrollbarsNeeded = canCenter;
		
		return canCenter;
	}

	/**
	 * Returns true if view can be centered horizontally
	 * @param {HTMLElement} view view to scale
	 * @param {String} type type of scaling
	 * @param {Boolean} scaleUp if scale up enabled 
	 * @param {Number} scale target scale value 
	 */
	self.canCenterVertically = function(view, type, scaleUp, scale, minimumScale, maximumScale) {
		var scaleNeededToFit = self.getViewFitToViewportScale(view, scaleUp);
		var scaleNeededToFitWidth = self.getViewFitToViewportWidthScale(view, scaleUp);
		var scaleNeededToFitHeight = self.getViewFitToViewportHeightScale(view, scaleUp);
		var canCenter = false;
		var minScale;

		type = type==null ? "none" : type;
		scale = scale==null ? 1 : scale;
		scaleUp = scaleUp == null ? false : scaleUp;
	
		if (type=="width") {
			canCenter = scaleNeededToFitHeight>=scaleNeededToFitWidth;
		}
		else if (type=="height") {
			minScale = Math.max(minimumScale, Math.min(maximumScale, scaleNeededToFit));
			canCenter = scaleNeededToFitHeight>=minScale;
		}
		else if (type=="fit") {
			canCenter = scaleNeededToFitHeight>=scaleNeededToFit;
		}
		else {
			if (scaleUp) {
				canCenter = false;
			}
			else if (scaleNeededToFitHeight>=1) {
				canCenter = true;
			}
		}

		self.verticalScrollbarsNeeded = canCenter;
		
		return canCenter;
	}

	self.getViewFitToViewportScale = function(view, scaleUp) {
		var enableScaleUp = scaleUp;
		var availableWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
		var availableHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
		var elementWidth = parseFloat(getComputedStyle(view, "style").width);
		var elementHeight = parseFloat(getComputedStyle(view, "style").height);
		var newScale = 1;

		// if element is not added to the document computed values are NaN
		if (isNaN(elementWidth) || isNaN(elementHeight)) {
			return newScale;
		}

		availableWidth -= self.horizontalPadding;
		availableHeight -= self.verticalPadding;

		if (enableScaleUp) {
			newScale = Math.min(availableHeight/elementHeight, availableWidth/elementWidth);
		}
		else if (elementWidth > availableWidth || elementHeight > availableHeight) {
			newScale = Math.min(availableHeight/elementHeight, availableWidth/elementWidth);
		}
		
		return newScale;
	}

	self.getViewFitToViewportWidthScale = function(view, scaleUp) {
		// need to get browser viewport width when element
		var isParentWindow = view && view.parentNode && view.parentNode===document.body;
		var enableScaleUp = scaleUp;
		var availableWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
		var elementWidth = parseFloat(getComputedStyle(view, "style").width);
		var newScale = 1;

		// if element is not added to the document computed values are NaN
		if (isNaN(elementWidth)) {
			return newScale;
		}

		availableWidth -= self.horizontalPadding;

		if (enableScaleUp) {
			newScale = availableWidth/elementWidth;
		}
		else if (elementWidth > availableWidth) {
			newScale = availableWidth/elementWidth;
		}
		
		return newScale;
	}

	self.getViewFitToViewportHeightScale = function(view, scaleUp) {
		var enableScaleUp = scaleUp;
		var availableHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
		var elementHeight = parseFloat(getComputedStyle(view, "style").height);
		var newScale = 1;

		// if element is not added to the document computed values are NaN
		if (isNaN(elementHeight)) {
			return newScale;
		}

		availableHeight -= self.verticalPadding;

		if (enableScaleUp) {
			newScale = availableHeight/elementHeight;
		}
		else if (elementHeight > availableHeight) {
			newScale = availableHeight/elementHeight;
		}
		
		return newScale;
	}

	self.keypressHandler = function(event) {
		var rightKey = 39;
		var leftKey = 37;
		
		// listen for both events 
		if (event.type=="keypress") {
			window.removeEventListener("keyup", self.keypressHandler);
		}
		else {
			window.removeEventListener("keypress", self.keypressHandler);
		}
		
		if (self.showNavigationControls) {
			if (self.navigationOnKeypress) {
				if (event.keyCode==rightKey) {
					self.nextView();
				}
				if (event.keyCode==leftKey) {
					self.previousView();
				}
			}
		}
		else if (self.navigationOnKeypress) {
			if (event.keyCode==rightKey) {
				self.nextView();
			}
			if (event.keyCode==leftKey) {
				self.previousView();
			}
		}
	}

	///////////////////////////////////
	// GENERAL FUNCTIONS
	///////////////////////////////////

	self.getViewById = function(id) {
		id = id ? id.replace("#", "") : "";
		var view = self.viewIds.indexOf(id)!=-1 && self.getElement(id);
		return view;
	}

	self.getViewIds = function() {
		var viewIds = self.getViewPreferenceValue(document.body, self.prefix + "view-ids");
		var viewId = null;

		viewIds = viewIds!=null && viewIds!="" ? viewIds.split(",") : [];

		if (viewIds.length==0) {
			viewId = self.getViewPreferenceValue(document.body, self.prefix + "view-id");
			viewIds = viewId ? [viewId] : [];
		}

		return viewIds;
	}

	self.getInitialViewId = function() {
		var viewId = self.getViewPreferenceValue(document.body, self.prefix + "view-id");
		return viewId;
	}

	self.getApplicationStylesheet = function() {
		var stylesheetId = self.getViewPreferenceValue(document.body, self.prefix + "stylesheet-id");
		self.applicationStylesheet = document.getElementById("applicationStylesheet");
		return self.applicationStylesheet.sheet;
	}

	self.getVisibleView = function() {
		var viewIds = self.getViewIds();
		
		for (var i=0;i<viewIds.length;i++) {
			var viewId = viewIds[i].replace(/[\#?\.?](.*)/, "$" + "1");
			var view = self.getElement(viewId);
			var postName = "_Class";

			if (view==null && viewId && viewId.lastIndexOf(postName)!=-1) {
				view = self.getElement(viewId.replace(postName, ""));
			}
			
			if (view) {
				var display = getComputedStyle(view).display;
		
				if (display=="block" || display=="flex") {
					return view;
				}
			}
		}

		return null;
	}

	self.getVisibleViews = function() {
		var viewIds = self.getViewIds();
		var views = [];
		
		for (var i=0;i<viewIds.length;i++) {
			var viewId = viewIds[i].replace(/[\#?\.?](.*)/, "$" + "1");
			var view = self.getElement(viewId);
			var postName = "_Class";

			if (view==null && viewId && viewId.lastIndexOf(postName)!=-1) {
				view = self.getElement(viewId.replace(postName, ""));
			}
			
			if (view) {
				var display = getComputedStyle(view).display;
				
				if (display=="none") {
					continue;
				}

				if (display=="block" || display=="flex") {
					views.push(view);
				}
			}
		}

		return views;
	}

	self.getStateNameByViewId = function(id) {
		var state = self.viewsDictionary[id];
		return state && state.stateName;
	}

	self.getMatchingViews = function(ids) {
		var views = self.addedViews.slice(0);
		var matchingViews = [];

		if (self.showByMediaQuery) {
			for (let index = 0; index < views.length; index++) {
				var viewId = views[index];
				var state = self.viewsDictionary[viewId];
				var rule = state && state.rule; 
				var matchResults = window.matchMedia(rule.conditionText);
				var view = self.views[viewId];
				
				if (matchResults.matches) {
					if (ids==true) {
						matchingViews.push(viewId);
					}
					else {
						matchingViews.push(view);
					}
				}
			}
		}

		return matchingViews;
	}

	self.ruleMatchesQuery = function(rule) {
		var result = window.matchMedia(rule.conditionText);
		return result.matches;
	}

	self.getViewsByStateName = function(stateName, matchQuery) {
		var views = self.addedViews.slice(0);
		var matchingViews = [];

		if (self.showByMediaQuery) {

			// find state name
			for (let index = 0; index < views.length; index++) {
				var viewId = views[index];
				var state = self.viewsDictionary[viewId];
				var rule = state.rule;
				var mediaRule = state.mediaRule;
				var view = self.views[viewId];
				var viewStateName = self.getStyleRuleValue(mediaRule, self.STATE_NAME, state);
				var stateFoundAtt = view.getAttribute(self.STATE_NAME)==state;
				var matchesResults = false;
				
				if (viewStateName==stateName) {
					if (matchQuery) {
						matchesResults = self.ruleMatchesQuery(rule);

						if (matchesResults) {
							matchingViews.push(view);
						}
					}
					else {
						matchingViews.push(view);
					}
				}
			}
		}

		return matchingViews;
	}

	self.getInitialView = function() {
		var viewId = self.getInitialViewId();
		viewId = viewId.replace(/[\#?\.?](.*)/, "$" + "1");
		var view = self.getElement(viewId);
		var postName = "_Class";

		if (view==null && viewId && viewId.lastIndexOf(postName)!=-1) {
			view = self.getElement(viewId.replace(postName, ""));
		}

		return view;
	}

	self.getViewIndex = function(view) {
		var viewIds = self.getViewIds();
		var id = view ? view.id : null;
		var index = id && viewIds ? viewIds.indexOf(id) : -1;

		return index;
	}

	self.syncronizeViewToURL = function() {
		var fragment = self.getHashFragment();

		if (self.showByMediaQuery) {
			var stateName = fragment;
			
			if (stateName==null || stateName=="") {
				var initialView = self.getInitialView();
				stateName = initialView ? self.getStateNameByViewId(initialView.id) : null;
			}
			
			self.showMediaQueryViewsByState(stateName);
			return;
		}

		var view = self.getViewById(fragment);
		var index = view ? self.getViewIndex(view) : 0;
		if (index==-1) index = 0;
		var currentView = self.hideViews(index);

		if (self.supportsPopState && currentView) {

			if (fragment==null) {
				window.history.replaceState({name:currentView.id}, null, "#"+ currentView.id);
			}
			else {
				window.history.pushState({name:currentView.id}, null, "#"+ currentView.id);
			}
		}
		
		self.setViewVariables(view);
		return view;
	}

	/**
	 * Set the currentView or currentOverlay properties and set the lastView or lastOverlay properties
	 */
	self.setViewVariables = function(view, overlay, parentView) {
		if (view) {
			if (self.currentView) {
				self.lastView = self.currentView;
			}
			self.currentView = view;
		}

		if (overlay) {
			if (self.currentOverlay) {
				self.lastOverlay = self.currentOverlay;
			}
			self.currentOverlay = overlay;
		}
	}

	self.getViewPreferenceBoolean = function(view, property, altValue) {
		var computedStyle = window.getComputedStyle(view);
		var value = computedStyle.getPropertyValue(property);
		var type = typeof value;
		
		if (value=="true" || (type=="string" && value.indexOf("true")!=-1)) {
			return true;
		}
		else if (value=="" && arguments.length==3) {
			return altValue;
		}

		return false;
	}

	self.getViewPreferenceValue = function(view, property, defaultValue) {
		var value = window.getComputedStyle(view).getPropertyValue(property);

		if (value===undefined) {
			return defaultValue;
		}
		
		value = value.replace(/^[\s\"]*/, "");
		value = value.replace(/[\s\"]*$/, "");
		value = value.replace(/^[\s"]*(.*?)[\s"]*$/, function (match, capture) { 
			return capture;
		});

		return value;
	}

	self.getStyleRuleValue = function(cssRule, property) {
		var value = cssRule ? cssRule.style.getPropertyValue(property) : null;

		if (value===undefined) {
			return null;
		}
		
		value = value.replace(/^[\s\"]*/, "");
		value = value.replace(/[\s\"]*$/, "");
		value = value.replace(/^[\s"]*(.*?)[\s"]*$/, function (match, capture) { 
			return capture;
		});

		return value;
	}

	/**
	 * Get the first defined value of property. Returns empty string if not defined
	 * @param {String} id id of element
	 * @param {String} property 
	 */
	self.getCSSPropertyValueForElement = function(id, property) {
		var styleSheets = document.styleSheets;
		var numOfStylesheets = styleSheets.length;
		var values = [];
		var selectorIDText = "#" + id;
		var selectorClassText = "." + id + "_Class";
		var value;

		for(var i=0;i<numOfStylesheets;i++) {
			var styleSheet = styleSheets[i];
			var cssRules = self.getStylesheetRules(styleSheet);
			var numOfCSSRules = cssRules.length;
			var cssRule;
			
			for (var j=0;j<numOfCSSRules;j++) {
				cssRule = cssRules[j];
				
				if (cssRule.media) {
					var mediaRules = cssRule.cssRules;
					var numOfMediaRules = mediaRules ? mediaRules.length : 0;
					
					for(var k=0;k<numOfMediaRules;k++) {
						var mediaRule = mediaRules[k];
						
						if (mediaRule.selectorText==selectorIDText || mediaRule.selectorText==selectorClassText) {
							
							if (mediaRule.style && mediaRule.style.getPropertyValue(property)!="") {
								value = mediaRule.style.getPropertyValue(property);
								values.push(value);
							}
						}
					}
				}
				else {

					if (cssRule.selectorText==selectorIDText || cssRule.selectorText==selectorClassText) {
						if (cssRule.style && cssRule.style.getPropertyValue(property)!="") {
							value = cssRule.style.getPropertyValue(property);
							values.push(value);
						}
					}
				}
			}
		}

		return values.pop();
	}

	self.getIsStyleDefined = function(id, property) {
		var value = self.getCSSPropertyValueForElement(id, property);
		return value!==undefined && value!="";
	}

	self.collectViews = function() {
		var viewIds = self.getViewIds();

		for (let index = 0; index < viewIds.length; index++) {
			const id = viewIds[index];
			const view = self.getElement(id);
			self.views[id] = view;
		}
		
		self.viewIds = viewIds;
	}

	self.collectOverlays = function() {
		var viewIds = self.getViewIds();
		var ids = [];

		for (let index = 0; index < viewIds.length; index++) {
			const id = viewIds[index];
			const view = self.getViewById(id);
			const isOverlay = view && self.isOverlay(view);
			
			if (isOverlay) {
				ids.push(id);
				self.overlays[id] = view;
			}
		}
		
		self.overlayIds = ids;
	}

	self.collectMediaQueries = function() {
		var viewIds = self.getViewIds();
		var styleSheet = self.getApplicationStylesheet();
		var cssRules = self.getStylesheetRules(styleSheet);
		var numOfCSSRules = cssRules ? cssRules.length : 0;
		var cssRule;
		var id = viewIds.length ? viewIds[0]: ""; // single view
		var selectorIDText = "#" + id;
		var selectorClassText = "." + id + "_Class";
		var viewsNotFound = viewIds.slice();
		var viewsFound = [];
		var selectorText = null;
		var property = self.prefix + "view-id";
		var stateName = self.prefix + "state";
		var stateValue;
		
		for (var j=0;j<numOfCSSRules;j++) {
			cssRule = cssRules[j];
			
			if (cssRule.media) {
				var mediaRules = cssRule.cssRules;
				var numOfMediaRules = mediaRules ? mediaRules.length : 0;
				var mediaViewInfoFound = false;
				var mediaId = null;
				
				for(var k=0;k<numOfMediaRules;k++) {
					var mediaRule = mediaRules[k];

					selectorText = mediaRule.selectorText;
					
					if (selectorText==".mediaViewInfo" && mediaViewInfoFound==false) {

						mediaId = self.getStyleRuleValue(mediaRule, property);
						stateValue = self.getStyleRuleValue(mediaRule, stateName);

						selectorIDText = "#" + mediaId;
						selectorClassText = "." + mediaId + "_Class";
						
						// prevent duplicates from load and domcontentloaded events
						if (self.addedViews.indexOf(mediaId)==-1) {
							self.addView(mediaId, cssRule, mediaRule, stateValue);
						}

						viewsFound.push(mediaId);

						if (viewsNotFound.indexOf(mediaId)!=-1) {
							viewsNotFound.splice(viewsNotFound.indexOf(mediaId));
						}

						mediaViewInfoFound = true;
					}

					if (selectorIDText==selectorText || selectorClassText==selectorText) {
						var styleObject = self.viewsDictionary[mediaId];
						if (styleObject) {
							styleObject.styleDeclaration = mediaRule;
						}
						break;
					}
				}
			}
			else {
				selectorText = cssRule.selectorText.replace(/[#|\s|*]?/g, "");

				if (viewIds.indexOf(selectorText)!=-1) {
					self.addView(selectorText, cssRule, null, stateValue);

					if (viewsNotFound.indexOf(selectorText)!=-1) {
						viewsNotFound.splice(viewsNotFound.indexOf(selectorText));
					}

					break;
				}
			}
		}

		if (viewsNotFound.length) {
			console.log("Could not find the following views:" + viewsNotFound.join(",") + "");
			console.log("Views found:" + viewsFound.join(",") + "");
		}
	}

	/**
	 * Adds a view. A view object contains the id of the view and the style rule
	 * Use enableMediaQuery(rule) to enable
	 * An array of view names are in self.addedViews array
	 */
	self.addView = function(viewId, cssRule, mediaRule, stateName) {
		var state = {name:viewId, rule:cssRule, id:viewId, mediaRule:mediaRule, stateName:stateName};
		self.addedViews.push(viewId);
		self.viewsDictionary[viewId] = state;
		self.mediaQueryDictionary[viewId] = cssRule;
	}

	self.hasView = function(name) {

		if (self.addedViews.indexOf(name)!=-1) {
			return true;
		}
		return false;
	}

	/**
	 * Go to view by id. Views are added in addView()
	 * @param {String} id id of view in current
	 * @param {Boolean} maintainPreviousState if true then do not hide other views
	 * @param {String} parent id of parent view
	 */
	self.goToView = function(id, maintainPreviousState, parent) {
		var state = self.viewsDictionary[id];

		if (state) {
			if (maintainPreviousState==false || maintainPreviousState==null) {
				self.hideViews();
			}
			self.enableMediaQuery(state.rule);
			self.updateViewLabel();
			self.updateURL();
		}
		else {
			var event = new Event(self.STATE_NOT_FOUND);
			self.stateName = id;
			window.dispatchEvent(event);
		}
	}

	/**
	 * Go to the view in the event targets CSS variable
	 */
	self.goToTargetView = function(event) {
		var button = event.currentTarget;
		var buttonComputedStyles = getComputedStyle(button);
		var actionTargetValue = buttonComputedStyles.getPropertyValue(self.prefix+"action-target").trim();
		var animation = buttonComputedStyles.getPropertyValue(self.prefix+"animation").trim();
		var targetType = buttonComputedStyles.getPropertyValue(self.prefix+"action-type").trim();
		var targetView = self.application ? null : self.getElement(actionTargetValue);
		var targetState = targetView ? self.getStateNameByViewId(targetView.id) : null;
		var actionTargetStyles = targetView ? targetView.style : null;
		var state = self.viewsDictionary[actionTargetValue];
		
		// navigate to page
		if (self.application==false || targetType=="page") {
			document.location.href = "./" + actionTargetValue;
			return;
		}

		// if view is found
		if (targetView) {

			if (self.currentOverlay) {
				self.removeOverlay(false);
			}

			if (self.showByMediaQuery) {
				var stateName = targetState;
				
				if (stateName==null || stateName=="") {
					var initialView = self.getInitialView();
					stateName = initialView ? self.getStateNameByViewId(initialView.id) : null;
				}
				self.showMediaQueryViewsByState(stateName, event);
				return;
			}

			// add animation set in event target style declaration
			if (animation && self.supportAnimations) {
				self.crossFade(self.currentView, targetView, false, animation);
			}
			else {
				self.setViewVariables(self.currentView);
				self.hideViews();
				self.enableMediaQuery(state.rule);
				self.scaleViewIfNeeded(targetView);
				self.centerView(targetView);
				self.updateViewLabel();
				self.updateURL();
			}
		}
		else {
			var stateEvent = new Event(self.STATE_NOT_FOUND);
			self.stateName = name;
			window.dispatchEvent(stateEvent);
		}

		event.stopImmediatePropagation();
	}

	/**
	 * Cross fade between views
	 **/
	self.crossFade = function(from, to, update, animation) {
		var targetIndex = to.parentNode
		var fromIndex = Array.prototype.slice.call(from.parentElement.children).indexOf(from);
		var toIndex = Array.prototype.slice.call(to.parentElement.children).indexOf(to);

		if (from.parentNode==to.parentNode) {
			var reverse = self.getReverseAnimation(animation);
			var duration = self.getAnimationDuration(animation, true);

			// if target view is above (higher index)
			// then fade in target view 
			// and after fade in then hide previous view instantly
			if (fromIndex<toIndex) {
				self.setElementAnimation(from, null);
				self.setElementAnimation(to, null);
				self.showViewByMediaQuery(to);
				self.fadeIn(to, update, animation);

				setTimeout(function() {
					self.setElementAnimation(to, null);
					self.setElementAnimation(from, null);
					self.hideView(from);
					self.updateURL();
					self.setViewVariables(to);
					self.updateViewLabel();
				}, duration)
			}
			// if target view is on bottom
			// then show target view instantly 
			// and fade out current view
			else if (fromIndex>toIndex) {
				self.setElementAnimation(to, null);
				self.setElementAnimation(from, null);
				self.showViewByMediaQuery(to);
				self.fadeOut(from, update, reverse);

				setTimeout(function() {
					self.setElementAnimation(to, null);
					self.setElementAnimation(from, null);
					self.hideView(from);
					self.updateURL();
					self.setViewVariables(to);
				}, duration)
			}
		}
	}

	self.fadeIn = function(element, update, animation) {
		self.showViewByMediaQuery(element);

		if (update) {
			self.updateURL(element);

			element.addEventListener("animationend", function(event) {
				element.style.animation = null;
				self.setViewVariables(element);
				self.updateViewLabel();
				element.removeEventListener("animationend", arguments.callee);
			});
		}

		self.setElementAnimation(element, null);
		
		element.style.animation = animation;
	}

	self.fadeOutCurrentView = function(animation, update) {
		if (self.currentView) {
			self.fadeOut(self.currentView, update, animation);
		}
		if (self.currentOverlay) {
			self.fadeOut(self.currentOverlay, update, animation);
		}
	}

	self.fadeOut = function(element, update, animation) {
		if (update) {
			element.addEventListener("animationend", function(event) {
				element.style.animation = null;
				self.hideView(element);
				element.removeEventListener("animationend", arguments.callee);
			});
		}

		element.style.animationPlayState = "paused";
		element.style.animation = animation;
		element.style.animationPlayState = "running";
	}

	self.getReverseAnimation = function(animation) {
		if (animation && animation.indexOf("reverse")==-1) {
			animation += " reverse";
		}

		return animation;
	}

	/**
	 * Get duration in animation string
	 * @param {String} animation animation value
	 * @param {Boolean} inMilliseconds length in milliseconds if true
	 */
	self.getAnimationDuration = function(animation, inMilliseconds) {
		var duration = 0;
		var expression = /.+(\d\.\d)s.+/;

		if (animation && animation.match(expression)) {
			duration = parseFloat(animation.replace(expression, "$" + "1"));
			if (duration && inMilliseconds) duration = duration * 1000;
		}

		return duration;
	}

	self.setElementAnimation = function(element, animation, priority) {
		element.style.setProperty("animation", animation, "important");
	}

	self.getElement = function(id) {
		var elementId = id ? id.trim() : id;
		var element = elementId ? document.getElementById(elementId) : null;

		return element;
	}

	self.resizeHandler = function(event) {
		
		if (self.showByMediaQuery) {
			if (self.enableDeepLinking) {
				var stateName = self.getHashFragment();

				if (stateName==null || stateName=="") {
					var initialView = self.getInitialView();
					stateName = initialView ? self.getStateNameByViewId(initialView.id) : null;
				}
				self.showMediaQueryViewsByState(stateName, event);
			}
		}
		else {
			var visibleViews = self.getVisibleViews();

			for (let index = 0; index < visibleViews.length; index++) {	
				var view = visibleViews[index];
				self.scaleViewIfNeeded(view);
			}
		}

		window.dispatchEvent(new Event(self.APPLICATION_RESIZE));
	}

	self.scaleViewIfNeeded = function(view) {

		if (self.scaleViewsOnResize) {
			if (view==null) {
				view = self.getVisibleView();
			}

			var isViewScaled = view.getAttributeNS(null, self.SIZE_STATE_NAME)=="false" ? false : true;

			if (isViewScaled) {
				self.scaleViewToFit(view, true);
			}
			else {
				self.scaleViewToActualSize(view);
			}
		}
		else if (view) {
			self.centerView(view);
		}
	}

	self.centerView = function(view) {

		if (self.scaleViewsToFit) {
			self.scaleViewToFit(view, true);
		}
		else {
			self.scaleViewToActualSize(view);  // for centering support for now
		}
	}

	self.preventDoubleClick = function(event) {
		event.stopImmediatePropagation();
	}

	self.getHashFragment = function() {
		var value = window.location.hash ? window.location.hash.replace("#", "") : "";
		return value;
	}

	self.showBlockElement = function(view) {
		view.style.display = "block";
	}

	self.hideElement = function(view) {
		view.style.display = "none";
	}

	self.showStateFunction = null;

	self.showMediaQueryViewsByState = function(state, event) {
		// browser will hide and show by media query (small, medium, large)
		// but if multiple views exists at same size user may want specific view
		// if showStateFunction is defined that is called with state fragment and user can show or hide each media matching view by returning true or false
		// if showStateFunction is not defined and state is defined and view has a defined state that matches then show that and hide other matching views
		// if no state is defined show view 
		// an viewChanging event is dispatched before views are shown or hidden that can be prevented 

		// get all matched queries
		// if state name is specified then show that view and hide other views
		// if no state name is defined then show
		var matchedViews = self.getMatchingViews();
		var matchMediaQuery = true;
		var foundViews = self.getViewsByStateName(state, matchMediaQuery);
		var showViews = [];
		var hideViews = [];

		// loop views that match media query 
		for (let index = 0; index < matchedViews.length; index++) {
			var view = matchedViews[index];
			
			// let user determine visible view
			if (self.showStateFunction!=null) {
				if (self.showStateFunction(view, state)) {
					showViews.push(view);
				}
				else {
					hideViews.push(view);
				}
			}
			// state was defined so check if view matches state
			else if (foundViews.length) {

				if (foundViews.indexOf(view)!=-1) {
					showViews.push(view);
				}
				else {
					hideViews.push(view);
				}
			}
			// if no state names are defined show view (define unused state name to exclude)
			else if (state==null || state=="") {
				showViews.push(view);
			}
		}

		if (showViews.length) {
			var viewChangingEvent = new Event(self.VIEW_CHANGING);
			viewChangingEvent.showViews = showViews;
			viewChangingEvent.hideViews = hideViews;
			window.dispatchEvent(viewChangingEvent);

			if (viewChangingEvent.defaultPrevented==false) {
				for (var index = 0; index < hideViews.length; index++) {
					var view = hideViews[index];

					if (self.isOverlay(view)) {
						self.removeOverlay(view);
					}
					else {
						self.hideElement(view);
					}
				}

				for (var index = 0; index < showViews.length; index++) {
					var view = showViews[index];

					if (index==showViews.length-1) {
						self.clearDisplay(view);
						self.setViewOptions(view);
						self.setViewVariables(view);
						self.centerView(view);
						self.updateURLState(view, state);
					}
				}
			}

			var viewChangeEvent = new Event(self.VIEW_CHANGE);
			viewChangeEvent.showViews = showViews;
			viewChangeEvent.hideViews = hideViews;
			window.dispatchEvent(viewChangeEvent);
		}
		
	}

	self.clearDisplay = function(view) {
		view.style.setProperty("display", null);
	}

	self.hashChangeHandler = function(event) {
		var fragment = self.getHashFragment();
		var view = self.getViewById(fragment);

		if (self.showByMediaQuery) {
			var stateName = fragment;

			if (stateName==null || stateName=="") {
				var initialView = self.getInitialView();
				stateName = initialView ? self.getStateNameByViewId(initialView.id) : null;
			}
			self.showMediaQueryViewsByState(stateName);
		}
		else {
			if (view) {
				self.hideViews();
				self.showView(view);
				self.setViewVariables(view);
				self.updateViewLabel();
				
				window.dispatchEvent(new Event(self.VIEW_CHANGE));
			}
			else {
				window.dispatchEvent(new Event(self.VIEW_NOT_FOUND));
			}
		}
	}

	self.popStateHandler = function(event) {
		var state = event.state;
		var fragment = state ? state.name : window.location.hash;
		var view = self.getViewById(fragment);

		if (view) {
			self.hideViews();
			self.showView(view);
			self.updateViewLabel();
		}
		else {
			window.dispatchEvent(new Event(self.VIEW_NOT_FOUND));
		}
	}

	self.doubleClickHandler = function(event) {
		var view = self.getVisibleView();
		var scaleValue = view ? self.getViewScaleValue(view) : 1;
		var scaleNeededToFit = view ? self.getViewFitToViewportScale(view) : 1;
		var scaleNeededToFitWidth = view ? self.getViewFitToViewportWidthScale(view) : 1;
		var scaleNeededToFitHeight = view ? self.getViewFitToViewportHeightScale(view) : 1;
		var scaleToFitType = self.scaleToFitType;

		// Three scenarios
		// - scale to fit on double click
		// - set scale to actual size on double click
		// - switch between scale to fit and actual page size

		if (scaleToFitType=="width") {
			scaleNeededToFit = scaleNeededToFitWidth;
		}
		else if (scaleToFitType=="height") {
			scaleNeededToFit = scaleNeededToFitHeight;
		}

		// if scale and actual size enabled then switch between
		if (self.scaleToFitOnDoubleClick && self.actualSizeOnDoubleClick) {
			var isViewScaled = view.getAttributeNS(null, self.SIZE_STATE_NAME);
			var isScaled = false;
			
			// if scale is not 1 then view needs scaling
			if (scaleNeededToFit!=1) {

				// if current scale is at 1 it is at actual size
				// scale it to fit
				if (scaleValue==1) {
					self.scaleViewToFit(view);
					isScaled = true;
				}
				else {
					// scale is not at 1 so switch to actual size
					self.scaleViewToActualSize(view);
					isScaled = false;
				}
			}
			else {
				// view is smaller than viewport 
				// so scale to fit() is scale actual size
				// actual size and scaled size are the same
				// but call scale to fit to retain centering
				self.scaleViewToFit(view);
				isScaled = false;
			}
			
			view.setAttributeNS(null, self.SIZE_STATE_NAME, isScaled+"");
			isViewScaled = view.getAttributeNS(null, self.SIZE_STATE_NAME);
		}
		else if (self.scaleToFitOnDoubleClick) {
			self.scaleViewToFit(view);
		}
		else if (self.actualSizeOnDoubleClick) {
			self.scaleViewToActualSize(view);
		}

	}

	self.scaleViewToFit = function(view) {
		return self.setViewScaleValue(view, true);
	}

	self.scaleViewToActualSize = function(view) {
		self.setViewScaleValue(view, false, 1);
	}

	self.onloadHandler = function(event) {
		self.initialize();
	}

	self.setElementHTML = function(id, value) {
		var element = self.getElement(id);
		element.innerHTML = value;
	}

	self.getStackArray = function(error) {
		var value = "";
		
		if (error==null) {
		  try {
			 error = new Error("Stack");
		  }
		  catch (e) {
			 
		  }
		}
		
		if ("stack" in error) {
		  value = error.stack;
		  var methods = value.split(/\n/g);
	 
		  var newArray = methods ? methods.map(function (value, index, array) {
			 value = value.replace(/\@.*/,"");
			 return value;
		  }) : null;
	 
		  if (newArray && newArray[0].includes("getStackTrace")) {
			 newArray.shift();
		  }
		  if (newArray && newArray[0].includes("getStackArray")) {
			 newArray.shift();
		  }
		  if (newArray && newArray[0]=="") {
			 newArray.shift();
		  }
	 
			return newArray;
		}
		
		return null;
	}

	self.log = function(value) {
		console.log.apply(this, [value]);
	}
	
	// initialize on load
	// sometimes the body size is 0 so we call this now and again later
	window.addEventListener("load", self.onloadHandler);
	window.document.addEventListener("DOMContentLoaded", self.onloadHandler);
}

window.application = new Application();
</script>
</head>
<body>
<div id="News-2__1">
	<svg class="Rectngulo_13">
		<rect id="Rectngulo_13" rx="54" ry="54" x="0" y="0" width="421" height="1602">
		</rect>
	</svg>
	<svg class="Rectngulo_14">
		<rect id="Rectngulo_14" rx="54" ry="54" x="0" y="0" width="417" height="1578">
		</rect>
	</svg>
	<img id="Sustraccin_4" src="Sustraccin_4.png" srcset="Sustraccin_4.png 1x, Sustraccin_4@2x.png 2x">
	<svg class="Rectngulo_21">
		<rect id="Rectngulo_21" rx="39" ry="39" x="0" y="0" width="375" height="1442">
		</rect>
	</svg>
	<div onclick="application.goToTargetView(event)" id="Grupo_2">
		<svg class="Rectngulo_22">
			<rect id="Rectngulo_22" rx="5" ry="5" x="0" y="0" width="45" height="45">
			</rect>
		</svg>
		<svg class="Icon_ionic-ios-arrow-back" viewBox="11.251 6.194 13.503 23.619">
			<path id="Icon_ionic-ios-arrow-back" d="M 15.32109355926514 18 L 24.2578125 9.0703125 C 24.91875076293945 8.409375190734863 24.91875076293945 7.340624809265137 24.2578125 6.686718940734863 C 23.59687423706055 6.025781631469727 22.52812576293945 6.032812595367432 21.8671875 6.686718940734863 L 11.7421875 16.8046875 C 11.10234355926514 17.44453048706055 11.08828163146973 18.47109413146973 11.69296836853027 19.13203048706055 L 21.86015701293945 29.3203125 C 22.19062614440918 29.65078163146973 22.62656402587891 29.8125 23.05546951293945 29.8125 C 23.484375 29.8125 23.92031288146973 29.65078163146973 24.25078201293945 29.3203125 C 24.91172027587891 28.65937423706055 24.91172027587891 27.59062576293945 24.25078201293945 26.93671798706055 L 15.32109355926514 18 Z">
			</path>
		</svg>
	</div>
	<div id="News">
		<span>News</span>
	</div>
	<div id="Lucy_Mission_News_from_NASA">
		<span>Lucy Mission News from NASA</span>
	</div>
	<div id="NASAs_Lucy_Mission_Prepares_fo">
		<span>NASA’s Lucy Mission Prepares for Launch <br/>to Trojan Asteroids</span>
	</div>
	<svg class="Rectngulo_17">
		<rect id="Rectngulo_17" rx="0" ry="0" x="0" y="0" width="18.424" height="18.424">
		</rect>
	</svg>
	<div id="Layer_2">
		<div id="Grupo_13">
			<div id="Grupo_8">
				<svg class="Elipse_19">
					<ellipse id="Elipse_19" rx="19.639965057373047" ry="19.639965057373047" cx="19.639965057373047" cy="19.639965057373047">
					</ellipse>
				</svg>
			</div>
			<div id="Grupo_9">
				<svg class="Elipse_20">
					<ellipse id="Elipse_20" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_21">
					<ellipse id="Elipse_21" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_22">
					<ellipse id="Elipse_22" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_23">
					<ellipse id="Elipse_23" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_24">
					<ellipse id="Elipse_24" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_25">
					<ellipse id="Elipse_25" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_26">
					<ellipse id="Elipse_26" rx="0.1653788834810257" ry="0.1653788834810257" cx="0.1653788834810257" cy="0.1653788834810257">
					</ellipse>
				</svg>
				<svg class="Elipse_27">
					<ellipse id="Elipse_27" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_28">
					<ellipse id="Elipse_28" rx="0.1653788834810257" ry="0.1653788834810257" cx="0.1653788834810257" cy="0.1653788834810257">
					</ellipse>
				</svg>
				<svg class="Elipse_29">
					<ellipse id="Elipse_29" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_30">
					<ellipse id="Elipse_30" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_31">
					<ellipse id="Elipse_31" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_32">
					<ellipse id="Elipse_32" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_33">
					<ellipse id="Elipse_33" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_34">
					<ellipse id="Elipse_34" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_35">
					<ellipse id="Elipse_35" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_36">
					<ellipse id="Elipse_36" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_37">
					<ellipse id="Elipse_37" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_38">
					<ellipse id="Elipse_38" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_39">
					<ellipse id="Elipse_39" rx="0.1653788834810257" ry="0.1653788834810257" cx="0.1653788834810257" cy="0.1653788834810257">
					</ellipse>
				</svg>
				<svg class="Elipse_40">
					<ellipse id="Elipse_40" rx="0.1653788834810257" ry="0.1653788834810257" cx="0.1653788834810257" cy="0.1653788834810257">
					</ellipse>
				</svg>
				<svg class="Elipse_41">
					<ellipse id="Elipse_41" rx="0.1653788834810257" ry="0.1653788834810257" cx="0.1653788834810257" cy="0.1653788834810257">
					</ellipse>
				</svg>
				<svg class="Elipse_42">
					<ellipse id="Elipse_42" rx="0.1653788834810257" ry="0.1653788834810257" cx="0.1653788834810257" cy="0.1653788834810257">
					</ellipse>
				</svg>
				<svg class="Elipse_43">
					<ellipse id="Elipse_43" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_44">
					<ellipse id="Elipse_44" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_45">
					<ellipse id="Elipse_45" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_46">
					<ellipse id="Elipse_46" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_47">
					<ellipse id="Elipse_47" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_48">
					<ellipse id="Elipse_48" rx="0.1648896038532257" ry="0.1648896038532257" cx="0.1648896038532257" cy="0.1648896038532257">
					</ellipse>
				</svg>
				<svg class="Elipse_49">
					<ellipse id="Elipse_49" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_50">
					<ellipse id="Elipse_50" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_51">
					<ellipse id="Elipse_51" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_52">
					<ellipse id="Elipse_52" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_53">
					<ellipse id="Elipse_53" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Elipse_54">
					<ellipse id="Elipse_54" rx="0.2201789766550064" ry="0.2201789766550064" cx="0.2201789766550064" cy="0.2201789766550064">
					</ellipse>
				</svg>
				<svg class="Trazado_4" viewBox="27.688 5.182 1.585 1.586">
					<path id="Trazado_4" d="M 28.72601699829102 6.012354373931885 L 29.27352905273438 5.960000514984131 L 28.72699546813965 5.92917537689209 C 28.70987129211426 5.823489665985107 28.62522315979004 5.740799903869629 28.5185604095459 5.727099895477295 L 28.46620750427246 5.182034492492676 L 28.43489265441895 5.731503486633301 C 28.33605766296387 5.75352144241333 28.26021957397461 5.83621072769165 28.24798583984375 5.938961029052734 L 27.68824195861816 5.989846706390381 L 28.25189971923828 6.020182609558105 C 28.2724494934082 6.114614963531494 28.34877967834473 6.188497066497803 28.44467926025391 6.206111431121826 L 28.49556541442871 6.767812728881836 L 28.52541160583496 6.207090377807617 C 28.62669372558594 6.18996524810791 28.70693588256836 6.112168312072754 28.72601699829102 6.012354373931885 Z">
					</path>
				</svg>
				<svg class="Trazado_5" viewBox="18.448 11.278 1.585 1.586">
					<path id="Trazado_5" d="M 19.4853515625 12.10788726806641 L 20.03286361694336 12.05553340911865 L 19.48633003234863 12.02470874786377 C 19.46969413757324 11.91902256011963 19.38455772399902 11.83633327484131 19.27789497375488 11.82263278961182 L 19.22554016113281 11.27756786346436 L 19.19471549987793 11.82703590393066 C 19.09539222717285 11.84905433654785 19.01955032348633 11.93174362182617 19.00732040405273 12.0344934463501 L 18.44757461547852 12.0853796005249 L 19.01123428344727 12.11571502685547 C 19.03178405761719 12.21014785766602 19.10811424255371 12.28402996063232 19.20401382446289 12.30164337158203 L 19.25489807128906 12.8633451461792 L 19.28523445129395 12.30262279510498 C 19.38651657104492 12.28598785400391 19.46675682067871 12.20770168304443 19.4853515625 12.10788726806641 Z">
					</path>
				</svg>
				<svg class="Trazado_6" viewBox="38.917 27.394 1.585 1.586">
					<path id="Trazado_6" d="M 39.95465469360352 28.22400856018066 L 40.50217056274414 28.17165565490723 L 39.95563888549805 28.14083099365234 C 39.93900299072266 28.0351448059082 39.85386657714844 27.95245742797852 39.74720001220703 27.93875694274902 L 39.69484329223633 27.39369201660156 L 39.66401672363281 27.94316101074219 C 39.56518173217773 27.96517944335938 39.48934173583984 28.0478687286377 39.47710800170898 28.15061950683594 L 38.91736602783203 28.20150566101074 L 39.48102569580078 28.23184013366699 C 39.5015754699707 28.32627296447754 39.57790374755859 28.40015602111816 39.67380142211914 28.41777038574219 L 39.72468566894531 28.97947120666504 L 39.75502014160156 28.41874885559082 C 39.85533142089844 28.4021110534668 39.93557739257813 28.32431411743164 39.95465469360352 28.22400856018066 Z">
					</path>
				</svg>
				<svg class="Trazado_7" viewBox="16.598 35.821 1.585 1.585">
					<path id="Trazado_7" d="M 17.6358470916748 36.65050506591797 L 18.18335914611816 36.59814834594727 L 17.63682556152344 36.56732177734375 C 17.61969947814941 36.46163558959961 17.53505325317383 36.37894439697266 17.42838859558105 36.3652458190918 L 17.37603569030762 35.82067108154297 L 17.34521102905273 36.36965179443359 C 17.24588584899902 36.39166641235352 17.17004585266113 36.47435760498047 17.15781402587891 36.57711029052734 L 16.59807014465332 36.62799453735352 L 17.16172981262207 36.65832901000977 C 17.18227958679199 36.75276184082031 17.25860786437988 36.82713317871094 17.35450744628906 36.84425354003906 L 17.40539360046387 37.40595626831055 L 17.43572998046875 36.84523391723633 C 17.53652191162109 36.8286018371582 17.61725425720215 36.75032043457031 17.6358470916748 36.65050506591797 Z">
					</path>
				</svg>
				<svg class="Trazado_8" viewBox="37.178 31.71 1.585 1.585">
					<path id="Trazado_8" d="M 38.21524047851563 32.54049682617188 L 38.76275634765625 32.48814010620117 L 38.21622467041016 32.45731353759766 C 38.19958877563477 32.35162734985352 38.11445236206055 32.26893615722656 38.00778579711914 32.2552375793457 L 37.95542907714844 31.71017265319824 L 37.92460250854492 32.25915145874023 C 37.82576751708984 32.28116989135742 37.74992752075195 32.36385726928711 37.73769378662109 32.46661376953125 L 37.17795181274414 32.51749801635742 L 37.74161148071289 32.54782867431641 C 37.76216125488281 32.64226150512695 37.8384895324707 32.71614456176758 37.93438720703125 32.73375701904297 L 37.98527145385742 33.29545974731445 L 38.01560592651367 32.73473739624023 C 38.11591720581055 32.71859741210938 38.19665145874023 32.64031219482422 38.21524047851563 32.54049682617188 Z">
					</path>
				</svg>
			</div>
			<div id="Grupo_11">
				<div id="Grupo_10">
					<svg class="Trazado_9" viewBox="2.176 4.021 48 35.904">
						<path id="Trazado_9" d="M 29.14582633972168 17.31340599060059 C 26.86232566833496 18.20097160339355 24.63509178161621 18.99312782287598 22.7557430267334 19.58124923706055 C 18.93685913085938 20.77706527709961 8.488143920898438 24.01418685913086 2.176346063613892 28.0948371887207 L 2.70477557182312 28.30033683776855 C 6.550568580627441 26.12790489196777 9.050333976745605 25.44535064697266 11.45322036743164 24.68940162658691 C 14.06601047515869 23.86739921569824 22.51256561279297 21.89068031311035 26.33731842041016 20.81425094604492 C 27.62952423095703 20.45071029663086 29.14288902282715 19.97463417053223 30.74579238891602 19.39531898498535 C 30.37295532226563 18.87520599365234 29.97956848144531 18.3536262512207 29.56563377380371 17.8330249786377 C 29.42716598510742 17.65737724304199 29.28673934936523 17.48416900634766 29.14582633972168 17.31340599060059 Z M 31.93573760986328 21.15871047973633 C 31.38284492492676 21.53203582763672 30.91948890686035 21.83001327514648 30.59509086608887 22.01789855957031 C 28.71623039245605 23.1041145324707 19.55629539489746 29.35719871520996 17.4724235534668 30.79570198059082 C 15.38855171203613 32.23420715332031 9.604694366455078 37.69464111328125 7.901977062225342 39.27993011474609 L 7.843262195587158 39.92530059814453 C 13.33305931091309 34.99328994750977 15.05534744262695 33.77692413330078 17.2375659942627 32.11677551269531 C 19.93842887878418 30.06176948547363 25.52559089660645 26.26001167297363 27.42451286315918 25.04169082641602 C 29.23976707458496 23.87718772888184 30.87692070007324 22.80613899230957 32.34624862670898 21.82609939575195 C 32.32226943969727 21.78597640991211 32.29829788208008 21.7458553314209 32.27431869506836 21.70524406433105 C 32.16374588012695 21.52371978759766 32.05072021484375 21.34170341491699 31.93573760986328 21.15871047973633 Z M 40.517333984375 12.09516525268555 C 37.84289169311523 13.66283988952637 33.62768936157227 15.55491161346436 29.53823280334473 17.16025924682617 C 29.6360912322998 17.2801342010498 29.73345756530762 17.4009895324707 29.83033752441406 17.5228214263916 C 30.28733253479004 18.09822273254395 30.71839141845703 18.67753791809082 31.1240119934082 19.25734329223633 C 34.33862686157227 18.07327079772949 37.86589050292969 16.48406791687012 40.66461181640625 14.56068229675293 C 39.33130645751953 15.82402038574219 34.92332077026367 19.11838722229004 32.23567199707031 20.95467948913574 C 32.37413787841797 21.18024063110352 32.50820541381836 21.40580368041992 32.63786697387695 21.63038444519043 C 36.70970916748047 18.90554809570313 39.44971084594727 16.89996337890625 41.04625701904297 15.55882740020752 C 43.248046875 13.70932388305664 48.26812744140625 9.569958686828613 50.17634582519531 4.021448612213135 C 46.82913589477539 8.278729438781738 42.87178421020508 10.71488761901855 40.517333984375 12.09516525268555 Z">
						</path>
					</svg>
				</div>
			</div>
			<svg class="Trazado_10" viewBox="14.56 9.032 20.913 24.421">
				<path id="Trazado_10" d="M 21.96113967895508 26.88091850280762 C 21.52812194824219 26.33585357666016 20.92923545837402 25.60583686828613 20.47957992553711 25.03973197937012 C 19.87824821472168 24.28280448913574 19.32192802429199 23.51805114746094 18.81209182739258 22.75427436828613 C 18.6457347869873 22.79586219787598 18.47986602783203 22.83745193481445 18.31399726867676 22.87904167175293 C 18.92951965332031 23.83951187133789 19.61305236816406 24.79851341247559 20.35774612426758 25.73598670959473 C 20.90183258056641 26.42098999023438 21.3965015411377 26.97241401672363 21.64995193481445 27.31540489196777 C 21.70132637023926 27.3848819732666 21.80309867858887 27.53852081298828 21.94058799743652 27.7430419921875 C 22.09911918640137 27.63539695739746 22.25911521911621 27.52677536010742 22.42057800292969 27.41717720031738 C 22.26449966430664 27.24739456176758 22.11037254333496 27.06880569458008 21.96113967895508 26.88091850280762 Z M 25.12193298339844 29.75009536743164 C 24.76622200012207 29.41346740722656 23.90360832214355 28.85127449035645 23.00576782226563 28.00774574279785 C 22.80760765075684 28.14376640319824 22.60749053955078 28.28174591064453 22.40688133239746 28.42070388793945 C 22.98668670654297 29.23781204223633 23.77639579772949 30.24134063720703 24.39485359191895 30.53393363952637 C 25.32645606994629 30.97526931762695 25.57745933532715 30.1816463470459 25.12193298339844 29.75009536743164 Z M 29.83033752441406 17.5228214263916 C 24.69674110412598 11.06130218505859 18.4255542755127 7.511528015136719 15.72175788879395 9.659985542297363 C 13.62174034118652 11.32845306396484 14.48386287689209 16.20468330383301 17.37848281860352 21.32702445983887 C 17.52820587158203 21.27565002441406 17.67646026611328 21.22525215148926 17.82324600219727 21.17534446716309 C 14.90171432495117 16.18462181091309 14.10222053527832 11.54667282104492 16.08285331726074 9.972638130187988 C 18.57185363769531 7.994941711425781 24.58176231384277 11.55841541290283 29.56661415100098 17.83253860473633 C 30.59851837158203 19.13110542297363 31.50565528869629 20.4345645904541 32.27383422851563 21.70524215698242 C 35.21542739868164 26.57364463806152 36.11816024780273 30.97624588012695 34.08566284179688 32.77339553833008 C 33.46377944946289 33.3233528137207 31.56339263916016 33.53913116455078 29.07390213012695 32.41866302490234 C 29.03916358947754 32.46220779418945 29.09494018554688 32.58012771606445 29.13848686218262 32.60899353027344 C 31.28743362426758 33.47307586669922 33.34586334228516 33.8023681640625 34.38510894775391 32.97693634033203 C 36.88242340087891 30.99239349365234 34.96393203735352 23.98434257507324 29.83033752441406 17.5228214263916 Z">
				</path>
			</svg>
			<div id="Grupo_12">
				<svg class="Trazado_11" viewBox="7.813 18.29 7.736 7.376">
					<path id="Trazado_11" d="M 7.813417911529541 18.28953552246094 L 11.10142421722412 18.28953552246094 L 13.86100006103516 22.97200775146484 C 13.86100006103516 22.97200775146484 13.86100006103516 19.58125114440918 13.86100006103516 19.31703567504883 C 13.86100006103516 18.90603446960449 13.33990955352783 18.37026596069336 13.15642738342285 18.28953552246094 C 13.37660694122314 18.28953552246094 15.2995023727417 18.28953552246094 15.43161010742188 18.28953552246094 C 15.29216289520264 18.32623100280762 14.8444652557373 18.86934089660645 14.8444652557373 19.31703567504883 C 14.8444652557373 19.53721618652344 14.8444652557373 24.45454597473145 14.8444652557373 24.68940353393555 C 14.8444652557373 25.0196704864502 15.32151985168457 25.47470855712891 15.54903888702393 25.65085220336914 L 12.37846183776855 25.65085220336914 L 9.574849128723145 20.94635963439941 C 9.574849128723145 20.94635963439941 9.574849128723145 24.45454406738281 9.574849128723145 24.64536666870117 C 9.574849128723145 25.01233291625977 9.934474945068359 25.3646183013916 10.30877876281738 25.66552925109863 L 7.886810779571533 25.66552925109863 C 8.231758117675781 25.51874351501465 8.562026023864746 25.05636787414551 8.591383934020996 24.68940353393555 C 8.620741844177246 24.32243728637695 8.591383934020996 19.58859062194824 8.591383934020996 19.38308906555176 C 8.591383934020996 18.93539237976074 8.158365249633789 18.56842803955078 7.813417911529541 18.28953552246094 Z">
					</path>
				</svg>
				<svg class="Trazado_12" viewBox="33.596 18.29 8.668 7.376">
					<path id="Trazado_12" d="M 37.88986968994141 25.65085220336914 L 42.26409149169922 25.65085220336914 C 42.02189254760742 25.59213829040527 41.75033950805664 25.3059024810791 41.60355758666992 24.92426109313965 C 41.45676803588867 24.54261779785156 39.13755035400391 18.2895336151123 39.13755035400391 18.2895336151123 L 37.47446060180664 18.2895336151123 C 37.00279235839844 18.62909889221191 36.49735641479492 18.98725509643555 35.95767211914063 19.36449432373047 C 35.95620727539063 19.37819480895996 35.95473861694336 19.39189529418945 35.95228958129883 19.40510559082031 C 35.87987518310547 19.8454647064209 34.57837295532227 24.55925178527832 34.49910736083984 24.79215240478516 C 34.38901901245117 25.11508178710938 33.82389450073242 25.47470855712891 33.59637451171875 25.66552925109863 L 35.95228958129883 25.66552925109863 C 35.71743011474609 25.40131378173828 35.526611328125 25.14443969726563 35.57064819335938 24.85086631774902 C 35.61468124389648 24.55729484558105 35.74679183959961 23.97015190124512 35.74679183959961 23.97015190124512 L 38.18344116210938 23.97015190124512 C 38.29352951049805 24.26372146606445 38.37572860717773 24.5274486541748 38.41830062866211 24.77747535705566 C 38.46967315673828 25.0783863067627 38.16142272949219 25.41599464416504 37.88986968994141 25.65085220336914 Z M 35.96697235107422 23.03072166442871 L 36.78897476196289 20.34453964233398 L 37.87519073486328 23.03072166442871 L 35.96697235107422 23.03072166442871 Z M 35.59658050537109 18.55766487121582 C 35.71743392944336 18.46861457824707 35.83877944946289 18.37907409667969 35.95962905883789 18.28953552246094 L 35.32110977172852 18.28953552246094 C 35.38471984863281 18.3482494354248 35.48991394042969 18.44072341918945 35.59658050537109 18.55766487121582 Z">
					</path>
				</svg>
				<svg class="Trazado_13" viewBox="16.892 18.29 8.384 7.376">
					<path id="Trazado_13" d="M 18.86640167236328 24.85086822509766 C 18.91043853759766 24.55729675292969 19.04254531860352 23.97015380859375 19.04254531860352 23.97015380859375 L 21.47919273376465 23.97015380859375 C 21.58928108215332 24.26372337341309 21.67148399353027 24.52745056152344 21.71405029296875 24.7774772644043 C 21.76542472839355 25.07838821411133 21.45717430114746 25.41599655151367 21.18561935424805 25.65085220336914 L 25.03679466247559 25.65085220336914 C 25.11703872680664 25.59703063964844 25.19679069519043 25.54320907592773 25.27654457092285 25.48987770080566 C 25.1273136138916 25.3577709197998 24.98982429504395 25.15961074829102 24.89930534362793 24.92426490783691 C 24.75251960754395 24.54262161254883 22.43330001831055 18.28953742980957 22.43330001831055 18.28953742980957 L 18.61686515808105 18.28953742980957 C 18.80034828186035 18.45834159851074 19.32877731323242 18.91337776184082 19.24804496765137 19.40510940551758 C 19.17612075805664 19.84546852111816 17.8741283416748 24.55925559997559 17.79486274719238 24.79215621948242 C 17.68477439880371 25.11508560180664 17.11964797973633 25.47471237182617 16.89212799072266 25.6655330657959 L 19.24804306030273 25.6655330657959 C 19.0131893157959 25.40131568908691 18.82236862182617 25.14443969726563 18.86640167236328 24.85086822509766 Z M 20.08472633361816 20.34453964233398 L 21.17094421386719 23.03072166442871 L 19.26272583007813 23.03072166442871 L 20.08472633361816 20.34453964233398 Z">
					</path>
				</svg>
				<svg class="Trazado_14" viewBox="26.535 18.186 6.505 8.103">
					<path id="Trazado_14" d="M 32.16961669921875 21.94352722167969 C 31.45134353637695 22.42204856872559 30.69344139099121 22.92161178588867 29.89492416381836 23.44318962097168 C 30.25308036804199 23.61688613891602 30.53833389282227 23.83510780334473 30.56573486328125 24.11693572998047 C 30.61662101745605 24.6463451385498 29.55291175842285 24.90224075317383 28.59146308898926 24.79215240478516 C 28.39917182922363 24.7701358795166 28.2103099822998 24.7197380065918 28.03025245666504 24.65221786499023 C 27.83062171936035 24.78089904785156 27.62903594970703 24.91056060791016 27.42451477050781 25.04169082641602 C 27.21656799316406 25.17526435852051 26.96409797668457 25.33966636657715 26.67590713500977 25.52950859069824 L 26.67590713500977 26.28937149047852 C 26.86672973632813 25.91506767272949 27.28409004211426 25.57990646362305 27.60799789428711 25.56278228759766 C 27.74744415283203 25.55544281005859 28.23183822631836 26.00313949584961 30.22812843322754 25.8930492401123 C 31.19691467285156 25.8397159576416 33.06843566894531 24.80683326721191 33.03908157348633 23.61786651611328 C 33.02146530151367 22.91525077819824 32.65449905395508 22.36724853515625 32.16961669921875 21.94352722167969 Z M 26.67541885375977 23.77932929992676 L 26.67541885375977 24.55338096618652 C 26.85205078125 24.43546295166016 27.02623558044434 24.31950187683105 27.19699668884277 24.20647811889648 C 26.92837905883789 24.01956939697266 26.73804664611816 23.84489440917969 26.67541885375977 23.77932929992676 Z M 31.487060546875 21.45766448974609 C 31.30113220214844 21.34757614135742 31.11275672912598 21.25118637084961 30.93221092224121 21.16604995727539 C 29.9927806854248 20.7256908416748 29.00931358337402 20.64496040344238 28.80381393432617 20.05047607421875 C 28.65898513793945 19.63115882873535 29.06802940368652 19.2431526184082 30.0661735534668 19.25783348083496 C 31.06431770324707 19.27251052856445 31.98906898498535 19.86699485778809 32.23860549926758 20.079833984375 L 32.23860549926758 18.1862964630127 C 32.16521453857422 18.25968933105469 31.84326362609863 18.62909889221191 31.5487117767334 18.56793975830078 C 30.98358535766602 18.45051002502441 30.02213668823242 18.29736328125 28.92124176025391 18.30372428894043 C 27.65888404846191 18.31106185913086 26.57266616821289 19.28669929504395 26.53597068786621 20.52019119262695 C 26.48459434509277 22.24492835998535 27.86438369750977 22.71464157104492 28.64234924316406 22.98619651794434 C 28.72259330749512 23.01408576965332 28.81408882141113 23.04393196105957 28.91341400146484 23.07573509216309 C 29.65957641601563 22.59036254882813 30.24965476989746 22.2165470123291 30.5950927734375 22.01741027832031 C 30.8270149230957 21.88383483886719 31.13086128234863 21.6920337677002 31.487060546875 21.45766448974609 Z">
					</path>
				</svg>
			</div>
		</div>
	</div>
	<div id="NASA_has_tested_the_functions_">
		<span>NASA has tested the functions of Lucy, the agency’s first spacecraft to study Jupiter’s Trojan asteroids, filled it with fuel, and is preparing to pack it into a capsule for launch Saturday, Oct. 16.<br/><br/>Named after characters in Greek mythology, these asteroids circle the Sun in two swarms, with one group leading ahead of Jupiter in its path, the other trailing behind it. Lucy will be the first spacecraft to visit these asteroids. By studying these asteroids up close, scientists hope to hone their theories on how our solar system’s planets formed 4.5 billion years ago and why they ended up in their current configuration.<br/><br/>“With Lucy, we’re going to eight never-before-seen asteroids in 12 years with a single spacecraft,” said Tom Statler, Lucy project scientist at NASA Headquarters in Washington. “This is a fantastic opportunity for discovery as we probe into our solar system’s distant past.”</span>
	</div>
	<div id="The_Lucy_spacecraft_is_schedul">
		<span>The Lucy spacecraft is scheduled to launch no earlier than Saturday, Oct. 16, on a ULA Atlas V 401 rocket from Pad 41. NASA’s Launch Services Program based at Kennedy Space Center is managing the launch. Over its 12-year primary mission, Lucy will explore a record-breaking number of asteroids, flying by one asteroid in the solar system’s main belt and seven Trojan asteroids. Additionally, Lucy’s path will circle back to Earth three times for gravity assists, making it the first spacecraft ever to return to the vicinity of Earth from the outer solar system.</span>
	</div>
	<div id="The_spacecraft_will_sit_in_lau">
		<span>“The spacecraft will sit in launch configuration and the engineering team will continuously monitor its health and status to make sure Lucy is ready to go,” said Jessica Lounsbury, the Lucy project systems engineer at Goddard. “And then it’s launch day.”<br/><br/>Lucy’s first launch attempt is scheduled for 5:34 a.m. EDT on Oct. 16. That day, the team will be “called to stations” at 1 a.m., which is when everyone is expected to arrive at mission control and other stations to monitor the spacecraft and run through the full launch countdown procedures. If weather or any other issues prohibit a launch that day, the team will have additional launch opportunities beginning the following day.</span>
	</div>
	<div id="The_United_Launch_Alliance_ULA">
		<span>The United Launch Alliance (ULA) Centaur stage for NASA’s Lucy mission is lifted by crane into the Vertical Integration Facility near Space Launch Complex 41 at Cape Canaveral Space Force Station in Florida on Thursday, Sept. 16, 2021. </span>
	</div>
	<img id="ksc-20210916-ph-kls01_0085_ori" src="ksc-20210916-ph-kls01_0085_ori.png" srcset="ksc-20210916-ph-kls01_0085_ori.png 1x, ksc-20210916-ph-kls01_0085_ori@2x.png 2x">
</div>
</body>
</html>